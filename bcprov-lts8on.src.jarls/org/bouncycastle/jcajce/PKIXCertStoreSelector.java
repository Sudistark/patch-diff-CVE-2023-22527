package org.bouncycastle.jcajce;

import java.security.cert.CertSelector;
import java.security.cert.CertStore;
import java.security.cert.CertStoreException;
import java.security.cert.Certificate;
import java.security.cert.X509CertSelector;
import java.util.Collection;
import org.bouncycastle.util.Selector;

public class PKIXCertStoreSelector<T extends Certificate> extends Object implements Selector<T> {
  private final CertSelector baseSelector;
  
  private PKIXCertStoreSelector(CertSelector baseSelector) { this.baseSelector = baseSelector; }
  
  public Certificate getCertificate() {
    if (this.baseSelector instanceof X509CertSelector)
      return ((X509CertSelector)this.baseSelector).getCertificate(); 
    return null;
  }
  
  public boolean match(Certificate cert) { return this.baseSelector.match(cert); }
  
  public Object clone() { return new PKIXCertStoreSelector(this.baseSelector); }
  
  public static Collection<? extends Certificate> getCertificates(PKIXCertStoreSelector selector, CertStore certStore) throws CertStoreException { return certStore.getCertificates(new SelectorClone(selector)); }
}
