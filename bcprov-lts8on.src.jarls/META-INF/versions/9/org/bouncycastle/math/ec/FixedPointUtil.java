package META-INF.versions.9.org.bouncycastle.math.ec;

import java.math.BigInteger;
import org.bouncycastle.math.ec.ECCurve;
import org.bouncycastle.math.ec.ECPoint;
import org.bouncycastle.math.ec.FixedPointPreCompInfo;
import org.bouncycastle.math.ec.PreCompInfo;

public class FixedPointUtil {
  public static final String PRECOMP_NAME = "bc_fixed_point";
  
  public static int getCombSize(ECCurve c) {
    BigInteger order = c.getOrder();
    return (order == null) ? (c.getFieldSize() + 1) : order.bitLength();
  }
  
  public static FixedPointPreCompInfo getFixedPointPreCompInfo(PreCompInfo preCompInfo) { return (preCompInfo instanceof FixedPointPreCompInfo) ? (FixedPointPreCompInfo)preCompInfo : null; }
  
  public static FixedPointPreCompInfo precompute(ECPoint p) {
    ECCurve c = p.getCurve();
    return (FixedPointPreCompInfo)c.precompute(p, "bc_fixed_point", new Object(c, p));
  }
}
