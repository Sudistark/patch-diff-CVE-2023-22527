package META-INF.versions.9.org.bouncycastle.crypto;

import java.security.Permission;
import java.util.HashSet;
import java.util.Set;
import org.bouncycastle.crypto.CryptoServicesPermission;

public class CryptoServicesPermission extends Permission {
  public static final String GLOBAL_CONFIG = "globalConfig";
  
  public static final String THREAD_LOCAL_CONFIG = "threadLocalConfig";
  
  public static final String DEFAULT_RANDOM = "defaultRandomConfig";
  
  public static final String CONSTRAINTS = "constraints";
  
  private final Set<String> actions = new HashSet();
  
  public CryptoServicesPermission(String name) {
    super(name);
    this.actions.add(name);
  }
  
  public boolean implies(Permission permission) {
    if (permission instanceof CryptoServicesPermission) {
      CryptoServicesPermission other = (CryptoServicesPermission)permission;
      if (getName().equals(other.getName()))
        return true; 
      if (this.actions.containsAll(other.actions))
        return true; 
    } 
    return false;
  }
  
  public boolean equals(Object obj) {
    if (obj instanceof CryptoServicesPermission) {
      CryptoServicesPermission other = (CryptoServicesPermission)obj;
      if (this.actions.equals(other.actions))
        return true; 
    } 
    return false;
  }
  
  public int hashCode() { return this.actions.hashCode(); }
  
  public String getActions() { return this.actions.toString(); }
}
