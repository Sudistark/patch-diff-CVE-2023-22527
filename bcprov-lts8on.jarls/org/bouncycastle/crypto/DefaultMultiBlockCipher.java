package org.bouncycastle.crypto;

public abstract class DefaultMultiBlockCipher implements MultiBlockCipher {
  public int getMultiBlockSize() { return getBlockSize(); }
  
  public int processBlocks(byte[] in, int inOff, int blockCount, byte[] out, int outOff) throws DataLengthException, IllegalStateException {
    int resultLen = 0;
    int blockSize = getMultiBlockSize();
    for (int i = 0; i != blockCount; i++) {
      resultLen += processBlock(in, inOff, out, outOff + resultLen);
      inOff += blockSize;
    } 
    return resultLen;
  }
}
