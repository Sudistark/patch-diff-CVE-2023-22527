package org.bouncycastle.crypto.modes.gcm;

public class BasicGCMExponentiator implements GCMExponentiator {
  private long[] x;
  
  public void init(byte[] x) { this.x = GCMUtil.asLongs(x); }
  
  public void exponentiateX(long pow, byte[] output) {
    long[] y = GCMUtil.oneAsLongs();
    if (pow > 0L) {
      long[] powX = new long[2];
      GCMUtil.copy(this.x, powX);
      do {
        if ((pow & 0x1L) != 0L)
          GCMUtil.multiply(y, powX); 
        GCMUtil.square(powX, powX);
        pow >>>= true;
      } while (pow > 0L);
    } 
    GCMUtil.asBytes(y, output);
  }
}
