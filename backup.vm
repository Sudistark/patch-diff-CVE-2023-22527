<html>
    <head>
        <title>$action.getActionName($action.getClass().getName())</title>
    </head>

    <body>
        <content tag="selectedWebItem">backup</content>
        #if ($actionErrors && $actionErrors.size() > 0)
            #foreach($errorHtml in $actionErrors)
            <div class="aui-message aui-message-error">
                <p class="title">$generalUtil.cleanQuietly($errorHtml)</p>
            </div>
            #end
            <p>
                <a class="aui-button" href="$req.contextPath/admin/backup.action">$action.getText("back.name")</a>
            </p>
        #else
            <form method="POST" name="backupform" class="aui" action="dobackup.action">
                <h2>$i18n.getText('title.backup')</h2>
                <p>
                    #if ($action.getFullExportBackwardsCompatibility() == $action.getBuildInformation().getVersionNumber())
                        #set ($isRange = 0)
                    #else
                        #set ($isRange = 1)
                    #end
                    $i18n.getText('backup.description', [$isRange, "$action.getFullExportBackwardsCompatibility()", "$action.getBuildInformation().getVersionNumber()"])
                    <a href="$req.contextPath/admin/migration.action">$i18n.getText('migration.assistant')</a>
                    $i18n.getText('backup.description.can.help')
                </p>
                <p>
                    $i18n.getText('site.exports.backup.strategy')
                    #doc('help.production.backup.strategy' $i18n.getText('more.about.backing.up.data'))
                </p>
                #form_xsrfToken()
                #scomponent("label='backupaction.backup.attachments'" "name='backupAttachments'" "value=#if ($backupAttachments) true #else false #end" "template='onofflist.vm'" "theme='aui'")
                #end
                #scomponent("label='archive.to.backup.folder'" "name='archiveBackup'" "value=false" "template='onofflist.vm'" "theme='aui'")
                #end
                #parse ("/setup/setup-button.vm")
                <div class="field-group">
                    #setupSubmitButton("backup", "backup", "$action.getText('backup-action')", "setup-restore-button", false)
                </div>

                #if (!$downloadEnabled)
                    #applyDecorator ("message")
                        #decoratorParam("type" "info")
                        $action.getText("backupaction.backup.download.disabled")
                        $action.getText("#doc('help.manually.backup.site' $i18n.getText('allow.site.exports.to.be.downloaded'))")
                    #end
                #end
            </form>

            <h2>$i18n.getText('title.restore')</h2>
            <p><span class="stepdesc">$action.getText("restore.minimum.versions", ["$action.getBuildInformation().getVersionNumber()", "$action.getMinimumFullImportVersion()", "$action.getMinimumSpaceImportVersion()"])</span></p>

            #if ($zduEnabled)
                #applyDecorator ("message")
                    #decoratorParam("type" "warning")
                    <p>
                        $i18n.getText('restore.unavailable.zdu')
                        <a href="$req.contextPath/plugins/servlet/zdu">$i18n.getText('restore.unavailable.zdu.check-progress')</a>
                    </p>
                #end
            #else
                #applyDecorator ("message")
                    #decoratorParam("type" "warning")
                    <b>$i18n.getText('reindex.now.or.later.lead')</b><br />
                        $i18n.getText('reindex.now.or.later.desc')
                    <p>
                        <b>$i18n.getText('importing.a.full.site.lead')</b><br />
                        $i18n.getText('importing.a.full.site.desc')
                    </p>
                        #if ($clusterNodeId)
                        <p>$i18n.getText('restore.site.synchrony.warning')</p>
                        #end
                    <p>
                        <b>$i18n.getText('importing.space.from.cloud.lead')</b><br />
                        $i18n.getText('import.users.email.matching.warning')
                        #doc('help.import.space.from.cloud' $i18n.getText('learn.more.url.name'))
                    </p>
                #end
                #set ($upload-and-restore-form-action = "restore.action")
                #set ($restore-local-file-form-action = "restore-local-file.action")
                #parse ('/importexport/includes/restore-include.vm')
            #end
        #end
	    #parse ( '/breadcrumbs.vm' )
    </body>
</html>
