<html>
	<head>
		<title>$action.getText("title.setup.jira.connection")</title>
	</head>
	<body>
        #parse ("/setup/analytics-data.vm")
        #parse ("/setup/setup-button.vm")
        #parse ( "/template/includes/actionerrors.vm" )

		<p>$action.getText("connecttojira.step.description")</p>

        <form name="connecttojira" method="POST" action="connecttojira.action" class="connecttojira aui max-width">

            <h2>$action.getText("jira.server.location.title")</h2>

            #if ($action.applinkAndCrowdReady)
                #stextfield("label='jira.base.url'" "name='jiraBaseUrl'" "theme='aui'" "readonly=true"
                            "longField=true"
                            "description=$action.getText('connecttojira.jira.base.url.description')")
            #else
                #stextfield("label='jira.base.url'" "name='jiraBaseUrl'" "theme='aui'"
                            "longField=true"
                            "description=$action.getText('connecttojira.jira.base.url.description')"
                            "required=$action.getText('required.field')")
            #end

            <h2>$action.getText("jira.administrator.login.title")</h2>

            <p class="stepdesc">$action.getText("jira.administrator.login.description")</p>

            #if ($action.applinkAndCrowdReady)
                #stextfield("label='admin.username.label'" "name='username'" "theme='aui'" "readonly=true"
                            "description=$action.getText('connecttojira.admin.username.description')")
            #else
                #stextfield("label='admin.username.label'" "name='username'" "theme='aui'"
                            "description=$action.getText('connecttojira.admin.username.description')"
                            "required=$action.getText('required.field')")
            #end

            #if ($action.applinkAndCrowdReady)
                #spassword("label='admin.password.label'" "name='password'" "theme='aui'" "readonly=true")
            #else
                #spassword("label='admin.password.label'" "name='password'" "required=$action.getText('required.field')")
            #end

            <h2>$action.getText("jira.advancedoptions.title")</h2>

            #if ($action.applinkAndCrowdReady)
                #stextfield("label='confluence.base.url'" "name='confluenceBaseUrl'" "theme='aui'" "readonly=true"
                            "longField=true"
                            "description=$action.getText('connecttojira.confluence.base.url.description')")
            #else
                #stextfield("label='confluence.base.url'" "name='confluenceBaseUrl'" "theme='aui'"
                            "longField=true"
                            "description=$action.getText('connecttojira.confluence.base.url.description')"
                            "required=$action.getText('required.field')")
            #end

            #stextfield("label='jira.user.groups'" "name='jiraUserGroups'" "theme='aui'"
                        "description=$action.getText('connecttojira.jira.user.groups.description')"
                        "required=$action.getText('required.field')")

            #stextfield("label='jira.admin.groups'" "name='jiraAdminGroups'" "theme='aui'"
                        "description=$action.getText('connecttojira.jira.admin.groups.description')"
                        "required=$action.getText('required.field')")

            #form_xsrfToken()
            <input type="hidden" name="applinkAndCrowdReady" value="$action.applinkAndCrowdReady">
            <input type="hidden" name="crowdApplicationName" value="$action.crowdApplicationName">
            <input type="hidden" name="crowdApplicationPassword" value="$action.crowdApplicationPassword">

            <div class="buttons-container">
                <div class="buttons">
                    #setupNextButton(false)
                    #if (!$action.applinkAndCrowdReady)
                        <a href="setupusermanagementchoice-start.action" class="cancel aui-button aui-button-link"> $action.getText("return.to.usermanagement.selection")</a>
                    #end
                </div>
            </div>
        </form>
	</body>
</html>
