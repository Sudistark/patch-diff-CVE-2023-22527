#macro(missingJdbcDriver $databaseValue $databaseTitle)
    #set ($id = $databaseValue + "-missing-driver-instruction")
    <div id="$id" class="invisible">
        <div class="field-group instruction-spacing">
            <div>
                <p><b>$action.getText("unbundled.driver.error.title", [$databaseTitle])</b></p>
                <ol class="jdbc-download-instruction-steps">
                    <li>$action.getText("unbundled.driver.step1.error", [$databaseTitle])</li>
                    <li>$action.getText("unbundled.driver.step2.error", [$webRealPath])</li>
                    <li>$action.getText("unbundled.driver.step3.error")</li>
                </ol>
            </div>
        </div>
        <div class="field-group form-buttons compact-form-buttons">
            <a class="aui-button" id="getJdbcDriver" name="getJdbcDriver" href="https://confluence.atlassian.com/x/3p4C">$action.getText('get.unbundled.driver.button', [$databaseTitle])</a>
        </div>
    </div>
#end

<html>
<head>
    <link rel="stylesheet" type="text/css"
          href="confluence-core/confluence-webapp/src/main/webapp/setup/includes/css/setup-select-database-type.css"/>
    <title>$action.getText("title.setup.dbchoose")</title>
    #requireResource("com.atlassian.auiplugin:aui-spinner")
    $webResourceManager.requireResourcesForContext("setup.setup-select-database-type")
    $webResourceManager.requireResourcesForContext("setup.setup-db")
</head>
<body>
    #parse ("/setup/analytics-data.vm")
    #parse ("/setup/setup-button.vm")
    #parse ("/setup/setup-progress-indicator.vm" )
    #parse ("/template/includes/actionerrors.vm" )

    <div class="setup-hint">$action.getText("setup.step.description.dbchoice")</div>

    <form method="POST" id="setupdbtype" name="setupdbtype" action="setupdbtype.action" class="aui">
        #form_xsrfToken()
        #sselect("label='database.type'" "name='dbConfigInfo.databaseType'" "id=dbConfigInfo-databaseType" "value=dbConfigInfo.databaseType" "list=dbConfigInfo.databases" "listKey=key" "listValue=value" "theme='aui'" "cssClass='select db-choice'"
                 "required=$action.getText('required.filed')")

        #if($missingMySQLDriver)
            #missingJdbcDriver("mysql" "MySQL")
        #end
        #if($missingOracleDriver)
            #missingJdbcDriver("oracle" "Oracle")
        #end

        <fieldset class="field-group">
            <label id="simple-label" for="dbConfigInfo.simple"><span>$action.getText("database.jdbc.form.setup.type")<span></label>
            <div class="radio">
                <input class="radio" type="radio" name="dbConfigInfo.simple" id="dbConfigInfo-simple" value="true" #if($dbConfigInfo.simple)checked#end/>
                <label for="dbConfigInfo-simple">$action.getText("database.jdbc.form.simple")</label>
            </div>
            <div class="radio">
                <input class="radio" type="radio" name="dbConfigInfo.simple" id="dbConfigInfo-customize" value="false" #if($dbConfigInfo.simple == false)checked#end/>
                <label for="dbConfigInfo-customize">$action.getText("database.jdbc.form.url")</label>
            </div>
            <div class="hint"><span>$action.getText("database.jdbc.form.url.hint")</span></div>
        </fieldset>

        #stextfield("label='database-url'" "name='dbConfigInfo.databaseUrl'" "id=dbConfigInfo-databaseUrl" "theme='aui'" "cssClass='long-field'"
                    "required=$action.getText('required.field')")

        #stextfield("label='database.jdbc.form.hostname'" "name='dbConfigInfo.hostname'" "id=dbConfigInfo-hostname" "theme='aui'" "cssClass='simpleUrl'"
                    "required=$action.getText('required.field')")
        <div class="field-group hint"><span class="simpleUrl">$action.getText("database.jdbc.form.hostname.hint")</span></div>

        #stextfield("label='database.jdbc.form.port'" "name='dbConfigInfo.port'" "id=dbConfigInfo-port" "theme='aui'" "cssClass='simpleUrl'"
                    "required=$action.getText('required.field')")
        <div class="field-group hint"><span class="simpleUrl">$action.getText("database.jdbc.form.port.hint")</span></div>

        #stextfield("label='database.jdbc.form.database.name'" "name='dbConfigInfo.databaseName'" "id=dbConfigInfo-databaseName" "theme='aui'" "cssClass='dbSpecific simpleUrl'"
                    "required=$action.getText('required.field')")

        #stextfield("label='database.jdbc.form.service.name'" "name='dbConfigInfo.serviceName'" "id=dbConfigInfo-serviceName" "theme='aui'" "cssClass='dbSpecific simpleUrl'"
                    "required=$action.getText('required.field')")

        #stextfield("label='database.jdbc.form.username'" "name='dbConfigInfo.userName'" "id=dbConfigInfo-username" "theme='aui'"
                    "required=$action.getText('required.field')")

        #spassword("label='password.name'" "name='dbConfigInfo.password'" "id=dbConfigInfo-password")

        #stextfield("label='database.jdbc.form.instance.name'" "name='dbConfigInfo.instanceName'" "id=dbConfigInfo-instanceName" "theme='aui'" "cssClass='dbSpecific simpleUrl'")

        <input type="hidden" id="database" name="database" value=""></input>

        <div class="field-group form-buttons compact-form-buttons testConnection">
            <button class="aui-button" id="testConnection" name="testConnection" type="button">$action.getText('setup.database.test.connection')</button>
            <div id="setupdb-successMessage" class="success">
                <span class="custom-icon icon-success"></span><div class="connectionSuccess">$action.getText("setup.database.test.connection.success")</div>
            </div>
            <div id="setupdb-spinner" class="button-spinner"></div>
        </div>

        <div class="buttons-container setup-progress-spinner-container">
            <div class="buttons">
                #if ($action.isThisNodeClustered())
                    #set($backLink = "$req.contextPath/setup/setupdbchoice-start.action?thisNodeClustered=true")
                #else
                    #set($backLink = "$req.contextPath/setup/setupdbchoice-start.action")
                #end
                #setupNextButton(false)
                <a href="$backLink" id="backLink" class="aui-button aui-button-link setup-back-button">$action.getText('setup.back')</a>
            </div>
        </div>
    </form>
</body>
</html>
