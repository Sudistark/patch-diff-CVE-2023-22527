package com.mysema.query.sql;

import com.mysema.query.types.Expression;
import com.mysema.query.types.ExpressionUtils;
import com.mysema.query.types.Operation;
import com.mysema.query.types.OperationImpl;
import com.mysema.query.types.Operator;
import com.mysema.query.types.Path;
import com.mysema.query.types.SubQueryExpression;

public final class UnionUtils {
  public static Expression<?> union(SubQueryExpression[] union, boolean unionAll) {
    Operator<Object> operator = unionAll ? SQLOps.UNION_ALL : SQLOps.UNION;
    Operation operation = union[0];
    for (int i = 1; i < union.length; i++)
      operation = OperationImpl.create(operation.getType(), operator, operation, union[i]); 
    return operation;
  }
  
  public static Expression<?> union(SubQueryExpression[] union, Path<?> alias, boolean unionAll) {
    Expression<?> rv = union(union, unionAll);
    return ExpressionUtils.as(rv, alias);
  }
}
