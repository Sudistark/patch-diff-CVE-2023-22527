package com.mysema.query.sql.spatial;

import com.mysema.query.spatial.SpatialOps;
import com.mysema.query.sql.SQLTemplates;
import com.mysema.query.sql.SchemaAndTable;
import com.mysema.query.sql.TeradataTemplates;
import com.mysema.query.sql.types.StringAsObjectType;

public class TeradataSpatialTemplates extends TeradataTemplates {
  public static final TeradataSpatialTemplates DEFAULT = new TeradataSpatialTemplates();
  
  public static SQLTemplates.Builder builder() { return new Object(); }
  
  public TeradataSpatialTemplates() { this('\\', false); }
  
  public TeradataSpatialTemplates(boolean quote) { this('\\', quote); }
  
  public TeradataSpatialTemplates(char escape, boolean quote) {
    super(escape, quote);
    addCustomType(GeometryWktClobType.DEFAULT);
    addCustomType(StringAsObjectType.DEFAULT);
    addTableOverride(new SchemaAndTable("public", "geometry_columns"), new SchemaAndTable("sysspatial", "geometry_columns"));
    addTableOverride(new SchemaAndTable("public", "spatial_ref_sys"), new SchemaAndTable("sysspatial", "spatial_ref_sys"));
    add(SpatialTemplatesSupport.getSpatialOps(false));
    add(SpatialOps.DISTANCE_SPHERE, "{0}.ST_SPHERICALDISTANCE({1})");
    add(SpatialOps.DISTANCE_SPHEROID, "{0}.ST_SPHEROIDALDISTANCE({1})");
  }
}
