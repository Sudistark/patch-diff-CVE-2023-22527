package com.mysema.query.sql.types;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Timestamp;
import java.util.Calendar;

public class CalendarType extends AbstractDateTimeType<Calendar> {
  public CalendarType() { super(93); }
  
  public CalendarType(int type) { super(type); }
  
  public String getLiteral(Calendar value) { return dateTimeFormatter.print(value.getTimeInMillis()); }
  
  public Calendar getValue(ResultSet rs, int startIndex) throws SQLException {
    Timestamp ts = rs.getTimestamp(startIndex);
    if (ts != null) {
      Calendar cal = Calendar.getInstance();
      cal.setTimeInMillis(ts.getTime());
      return cal;
    } 
    return null;
  }
  
  public Class<Calendar> getReturnedClass() { return Calendar.class; }
  
  public void setValue(PreparedStatement st, int startIndex, Calendar value) throws SQLException { st.setTimestamp(startIndex, new Timestamp(value.getTimeInMillis())); }
}
