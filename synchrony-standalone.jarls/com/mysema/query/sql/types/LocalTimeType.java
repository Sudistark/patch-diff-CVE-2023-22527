package com.mysema.query.sql.types;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Time;
import org.joda.time.DateTimeZone;
import org.joda.time.LocalTime;

public class LocalTimeType extends AbstractDateTimeType<LocalTime> {
  public LocalTimeType() { super(92); }
  
  public LocalTimeType(int type) { super(type); }
  
  public String getLiteral(LocalTime value) { return timeFormatter.print(value); }
  
  public Class<LocalTime> getReturnedClass() { return LocalTime.class; }
  
  public LocalTime getValue(ResultSet rs, int startIndex) throws SQLException {
    Time time = rs.getTime(startIndex, utc());
    return (time != null) ? new LocalTime(time.getTime(), DateTimeZone.UTC) : null;
  }
  
  public void setValue(PreparedStatement st, int startIndex, LocalTime value) throws SQLException { st.setTime(startIndex, new Time(value.getMillisOfDay()), utc()); }
}
