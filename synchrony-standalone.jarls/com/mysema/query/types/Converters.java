package com.mysema.query.types;

import com.google.common.base.Function;

@Deprecated
public final class Converters {
  private static final Constant<String> PERCENT = ConstantImpl.create("%");
  
  private final char escape;
  
  public final Function<Object, Object> toLowerCase;
  
  public final Function<Object, Object> toUpperCase;
  
  public final Function<Object, Object> toStartsWithViaLike;
  
  public final Function<Object, Object> toStartsWithViaLikeLower;
  
  public final Function<Object, Object> toEndsWithViaLike;
  
  public final Function<Object, Object> toEndsWithViaLikeLower;
  
  public final Function<Object, Object> toContainsViaLike;
  
  public final Function<Object, Object> toContainsViaLikeLower;
  
  public Converters(char escape) {
    this.toLowerCase = new Object(this);
    this.toUpperCase = new Object(this);
    this.toStartsWithViaLike = new Object(this);
    this.toStartsWithViaLikeLower = new Object(this);
    this.toEndsWithViaLike = new Object(this);
    this.toEndsWithViaLikeLower = new Object(this);
    this.toContainsViaLike = new Object(this);
    this.toContainsViaLikeLower = new Object(this);
    this.escape = escape;
  }
  
  public String escapeForLike(String str) {
    StringBuilder rv = new StringBuilder(str.length() + 3);
    for (int i = 0; i < str.length(); i++) {
      char ch = str.charAt(i);
      if (ch == this.escape || ch == '%' || ch == '_')
        rv.append(this.escape); 
      rv.append(ch);
    } 
    return rv.toString();
  }
}
