package com.hazelcast.client.impl.protocol.task.mapreduce;

import com.hazelcast.client.impl.protocol.ClientMessage;
import com.hazelcast.client.impl.protocol.codec.MapReduceForSetCodec;
import com.hazelcast.instance.Node;
import com.hazelcast.mapreduce.CombinerFactory;
import com.hazelcast.mapreduce.KeyPredicate;
import com.hazelcast.mapreduce.KeyValueSource;
import com.hazelcast.mapreduce.Mapper;
import com.hazelcast.mapreduce.ReducerFactory;
import com.hazelcast.mapreduce.impl.SetKeyValueSource;
import com.hazelcast.nio.Connection;
import java.util.Collection;
import java.util.List;

public class MapReduceForSetMessageTask extends AbstractMapReduceTask<MapReduceForSetCodec.RequestParameters> {
  public MapReduceForSetMessageTask(ClientMessage clientMessage, Node node, Connection connection) { super(clientMessage, node, connection); }
  
  protected String getJobId() { return ((MapReduceForSetCodec.RequestParameters)this.parameters).jobId; }
  
  protected int getChunkSize() { return ((MapReduceForSetCodec.RequestParameters)this.parameters).chunkSize; }
  
  protected String getTopologyChangedStrategy() { return ((MapReduceForSetCodec.RequestParameters)this.parameters).topologyChangedStrategy; }
  
  protected KeyValueSource getKeyValueSource() { return new SetKeyValueSource(((MapReduceForSetCodec.RequestParameters)this.parameters).setName); }
  
  protected Mapper getMapper() { return (Mapper)this.serializationService.toObject(((MapReduceForSetCodec.RequestParameters)this.parameters).mapper); }
  
  protected CombinerFactory getCombinerFactory() { return (CombinerFactory)this.serializationService.toObject(((MapReduceForSetCodec.RequestParameters)this.parameters).combinerFactory); }
  
  protected ReducerFactory getReducerFactory() { return (ReducerFactory)this.serializationService.toObject(((MapReduceForSetCodec.RequestParameters)this.parameters).reducerFactory); }
  
  protected Collection getKeys() { return ((MapReduceForSetCodec.RequestParameters)this.parameters).keys; }
  
  protected KeyPredicate getPredicate() { return (KeyPredicate)this.serializationService.toObject(((MapReduceForSetCodec.RequestParameters)this.parameters).predicate); }
  
  protected MapReduceForSetCodec.RequestParameters decodeClientMessage(ClientMessage clientMessage) { return MapReduceForSetCodec.decodeRequest(clientMessage); }
  
  protected ClientMessage encodeResponse(Object response) { return MapReduceForSetCodec.encodeResponse((List)response); }
  
  public String getDistributedObjectName() { return ((MapReduceForSetCodec.RequestParameters)this.parameters).name; }
}
