package com.hazelcast.client.impl.protocol.task;

import com.hazelcast.client.impl.protocol.ClientMessage;
import com.hazelcast.instance.Node;
import com.hazelcast.nio.Connection;

public abstract class AbstractRemoveListenerMessageTask<P> extends AbstractCallableMessageTask<P> implements ListenerMessageTask {
  protected AbstractRemoveListenerMessageTask(ClientMessage clientMessage, Node node, Connection connection) { super(clientMessage, node, connection); }
  
  public final Object call() {
    this.endpoint.removeDestroyAction(getRegistrationId());
    return Boolean.valueOf(deRegisterListener());
  }
  
  protected abstract boolean deRegisterListener();
  
  protected abstract String getRegistrationId();
  
  public Object[] getParameters() { return new Object[] { getRegistrationId() }; }
}
