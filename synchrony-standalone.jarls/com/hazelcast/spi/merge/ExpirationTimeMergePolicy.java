package com.hazelcast.spi.merge;

import com.hazelcast.spi.impl.merge.AbstractSplitBrainMergePolicy;

public class ExpirationTimeMergePolicy<V, T extends MergingExpirationTime<V>> extends AbstractSplitBrainMergePolicy<V, T> {
  public V merge(T mergingValue, T existingValue) {
    if (mergingValue == null)
      return (V)existingValue.getValue(); 
    if (existingValue == null)
      return (V)mergingValue.getValue(); 
    if (mergingValue.getExpirationTime() >= existingValue.getExpirationTime())
      return (V)mergingValue.getValue(); 
    return (V)existingValue.getValue();
  }
  
  public int getId() { return 12; }
}
