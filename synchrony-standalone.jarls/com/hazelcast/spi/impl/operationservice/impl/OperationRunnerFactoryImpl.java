package com.hazelcast.spi.impl.operationservice.impl;

import com.hazelcast.spi.impl.operationexecutor.OperationRunner;
import com.hazelcast.spi.impl.operationexecutor.OperationRunnerFactory;

class OperationRunnerFactoryImpl implements OperationRunnerFactory {
  private OperationServiceImpl operationService;
  
  private int genericId;
  
  OperationRunnerFactoryImpl(OperationServiceImpl operationService) { this.operationService = operationService; }
  
  public OperationRunner createAdHocRunner() { return new OperationRunnerImpl(this.operationService, -2, 0, null); }
  
  public OperationRunner createPartitionRunner(int partitionId) { return new OperationRunnerImpl(this.operationService, partitionId, 0, this.operationService.failedBackupsCount); }
  
  public OperationRunner createGenericRunner() { return new OperationRunnerImpl(this.operationService, -1, this.genericId++, null); }
}
