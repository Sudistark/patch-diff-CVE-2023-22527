package com.hazelcast.spi.impl.proxyservice.impl.operations;

import com.hazelcast.nio.ObjectDataInput;
import com.hazelcast.nio.ObjectDataOutput;
import com.hazelcast.nio.serialization.IdentifiedDataSerializable;
import com.hazelcast.spi.Operation;
import com.hazelcast.spi.impl.SpiDataSerializerHook;
import com.hazelcast.spi.impl.proxyservice.impl.ProxyServiceImpl;
import java.io.IOException;

public class DistributedObjectDestroyOperation extends Operation implements IdentifiedDataSerializable {
  private String serviceName;
  
  private String name;
  
  public DistributedObjectDestroyOperation() {}
  
  public DistributedObjectDestroyOperation(String serviceName, String name) {
    this.serviceName = serviceName;
    this.name = name;
  }
  
  public void run() {
    ProxyServiceImpl proxyService = (ProxyServiceImpl)getService();
    proxyService.destroyLocalDistributedObject(this.serviceName, this.name, false);
  }
  
  public Object getResponse() { return Boolean.TRUE; }
  
  protected void writeInternal(ObjectDataOutput out) throws IOException {
    super.writeInternal(out);
    out.writeUTF(this.serviceName);
    out.writeObject(this.name);
  }
  
  protected void readInternal(ObjectDataInput in) throws IOException {
    super.readInternal(in);
    this.serviceName = in.readUTF();
    this.name = (String)in.readObject();
  }
  
  public int getFactoryId() { return SpiDataSerializerHook.F_ID; }
  
  public int getId() { return 15; }
}
