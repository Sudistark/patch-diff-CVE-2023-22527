package com.hazelcast.collection.impl.queue.operations;

import com.hazelcast.collection.impl.queue.QueueContainer;
import com.hazelcast.monitor.impl.LocalQueueStatsImpl;
import com.hazelcast.spi.ReadonlyOperation;

public class IsEmptyOperation extends QueueOperation implements ReadonlyOperation {
  public IsEmptyOperation() {}
  
  public IsEmptyOperation(String name) { super(name); }
  
  public void run() {
    QueueContainer queueContainer = getContainer();
    this.response = Boolean.valueOf((queueContainer.size() == 0));
  }
  
  public void afterRun() {
    LocalQueueStatsImpl stats = getQueueService().getLocalQueueStatsImpl(this.name);
    stats.incrementOtherOperations();
  }
  
  public int getId() { return 40; }
}
