package com.hazelcast.collection.impl.queue.operations;

import com.hazelcast.collection.impl.queue.QueueContainer;
import com.hazelcast.monitor.impl.LocalQueueStatsImpl;
import com.hazelcast.nio.serialization.Data;
import com.hazelcast.spi.ReadonlyOperation;
import com.hazelcast.spi.impl.SerializableList;
import java.util.List;

public class IteratorOperation extends QueueOperation implements ReadonlyOperation {
  public IteratorOperation() {}
  
  public IteratorOperation(String name) { super(name); }
  
  public void run() {
    QueueContainer queueContainer = getContainer();
    List<Data> dataList = queueContainer.getAsDataList();
    this.response = new SerializableList(dataList);
  }
  
  public void afterRun() {
    LocalQueueStatsImpl stats = getQueueService().getLocalQueueStatsImpl(this.name);
    stats.incrementOtherOperations();
  }
  
  public int getId() { return 14; }
}
