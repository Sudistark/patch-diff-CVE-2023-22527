package com.hazelcast.collection.impl.queue.operations;

import com.hazelcast.collection.impl.queue.QueueContainer;
import com.hazelcast.spi.ProxyService;
import com.hazelcast.spi.impl.MutatingOperation;

public class CheckAndEvictOperation extends QueueOperation implements MutatingOperation {
  public CheckAndEvictOperation() {}
  
  public CheckAndEvictOperation(String name) { super(name); }
  
  public void run() {
    QueueContainer queueContainer = getContainer();
    if (queueContainer.isEvictable()) {
      ProxyService proxyService = getNodeEngine().getProxyService();
      proxyService.destroyDistributedObject(getServiceName(), this.name);
    } 
  }
  
  public int getId() { return 35; }
}
