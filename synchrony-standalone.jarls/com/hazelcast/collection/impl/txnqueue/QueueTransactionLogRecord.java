package com.hazelcast.collection.impl.txnqueue;

import com.hazelcast.collection.impl.txncollection.CollectionTransactionLogRecord;
import com.hazelcast.collection.impl.txnqueue.operations.TxnCommitOperation;
import com.hazelcast.collection.impl.txnqueue.operations.TxnPrepareOperation;
import com.hazelcast.collection.impl.txnqueue.operations.TxnRollbackOperation;
import com.hazelcast.spi.Operation;

public class QueueTransactionLogRecord extends CollectionTransactionLogRecord {
  public QueueTransactionLogRecord() {}
  
  public QueueTransactionLogRecord(String transactionId, String name, int partitionId) { super("hz:impl:queueService", transactionId, name, partitionId); }
  
  public Operation newPrepareOperation() {
    long[] itemIds = createItemIdArray();
    return new TxnPrepareOperation(this.partitionId, this.name, itemIds, this.transactionId);
  }
  
  public Operation newCommitOperation() { return new TxnCommitOperation(this.partitionId, this.name, this.operationList); }
  
  public Operation newRollbackOperation() {
    long[] itemIds = createItemIdArray();
    return new TxnRollbackOperation(this.partitionId, this.name, itemIds);
  }
  
  public int getId() { return 44; }
}
