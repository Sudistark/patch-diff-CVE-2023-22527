package com.hazelcast.map.impl.operation;

import com.hazelcast.map.impl.MapContainer;
import com.hazelcast.map.impl.PartitionContainer;
import com.hazelcast.spi.AbstractLocalOperation;
import com.hazelcast.spi.PartitionAwareOperation;
import com.hazelcast.spi.impl.AllowedDuringPassiveState;

public class MapPartitionDestroyOperation extends AbstractLocalOperation implements PartitionAwareOperation, AllowedDuringPassiveState {
  private final PartitionContainer partitionContainer;
  
  private final MapContainer mapContainer;
  
  public MapPartitionDestroyOperation(PartitionContainer container, MapContainer mapContainer) {
    this.partitionContainer = container;
    this.mapContainer = mapContainer;
    setPartitionId(this.partitionContainer.getPartitionId());
  }
  
  public void run() { this.partitionContainer.destroyMap(this.mapContainer); }
  
  public boolean validatesTarget() { return false; }
}
