package com.hazelcast.map.impl.operation;

import com.hazelcast.map.impl.record.Record;
import com.hazelcast.nio.serialization.Data;
import com.hazelcast.spi.BackupOperation;

public class SetTtlBackupOperation extends KeyBasedMapOperation implements BackupOperation {
  public SetTtlBackupOperation() {}
  
  public SetTtlBackupOperation(String name, Data dataKey, long ttl) { super(name, dataKey, ttl, -1L); }
  
  public int getId() { return 149; }
  
  public void run() { this.recordStore.setTtl(this.dataKey, this.ttl); }
  
  public void afterRun() {
    Record record = this.recordStore.getRecord(this.dataKey);
    if (record != null)
      publishWanUpdate(this.dataKey, record.getValue()); 
  }
}
