package com.hazelcast.multimap.impl.operations;

import com.hazelcast.multimap.impl.MultiMapContainer;
import com.hazelcast.multimap.impl.MultiMapService;
import com.hazelcast.spi.ReadonlyOperation;

public class KeySetOperation extends AbstractMultiMapOperation implements ReadonlyOperation {
  public KeySetOperation() {}
  
  public KeySetOperation(String name) { super(name); }
  
  public void run() {
    MultiMapContainer container = getOrCreateContainer();
    ((MultiMapService)getService()).getLocalMultiMapStatsImpl(this.name).incrementOtherOperations();
    this.response = new MultiMapResponse(container.keySet(), getValueCollectionType(container));
  }
  
  public int getId() { return 14; }
}
