package com.hazelcast.multimap.impl.operations;

import com.hazelcast.multimap.impl.MultiMapContainer;
import com.hazelcast.multimap.impl.MultiMapService;
import com.hazelcast.spi.ReadonlyOperation;

public class EntrySetOperation extends AbstractMultiMapOperation implements ReadonlyOperation {
  public EntrySetOperation() {}
  
  public EntrySetOperation(String name) { super(name); }
  
  public void run() {
    MultiMapContainer container = getOrCreateContainer();
    ((MultiMapService)getService()).getLocalMultiMapStatsImpl(this.name).incrementOtherOperations();
    this.response = new EntrySetResponse(container.copyCollections(), getNodeEngine());
  }
  
  public int getId() { return 10; }
}
