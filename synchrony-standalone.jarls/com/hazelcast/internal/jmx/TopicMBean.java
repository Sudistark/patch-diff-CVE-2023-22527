package com.hazelcast.internal.jmx;

import com.hazelcast.config.Config;
import com.hazelcast.config.TopicConfig;
import com.hazelcast.core.ITopic;

@ManagedDescription("ITopic")
public class TopicMBean extends HazelcastMBean<ITopic> {
  protected TopicMBean(ITopic managedObject, ManagementService service) {
    super(managedObject, service);
    this.objectName = service.createObjectName("ITopic", managedObject.getName());
  }
  
  @ManagedAnnotation("localCreationTime")
  @ManagedDescription("the creation time of this topic on this member")
  public long getLocalCreationTime() { return ((ITopic)this.managedObject).getLocalTopicStats().getCreationTime(); }
  
  @ManagedAnnotation("localPublishOperationCount")
  @ManagedDescription(" the total number of published messages of this topic on this member")
  public long getLocalPublishOperationCount() { return ((ITopic)this.managedObject).getLocalTopicStats().getPublishOperationCount(); }
  
  @ManagedAnnotation("localReceiveOperationCount")
  @ManagedDescription("the total number of received messages of this topic on this member")
  public long getLocalReceiveOperationCount() { return ((ITopic)this.managedObject).getLocalTopicStats().getReceiveOperationCount(); }
  
  @ManagedAnnotation("name")
  @ManagedDescription("Name of the DistributedObject")
  public String getName() { return ((ITopic)this.managedObject).getName(); }
  
  @ManagedAnnotation("config")
  public String getConfig() {
    Config config = this.service.instance.getConfig();
    TopicConfig topicConfig = config.findTopicConfig(((ITopic)this.managedObject).getName());
    return topicConfig.toString();
  }
}
