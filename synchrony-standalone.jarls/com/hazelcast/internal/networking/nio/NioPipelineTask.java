package com.hazelcast.internal.networking.nio;

abstract class NioPipelineTask implements Runnable {
  private final NioPipeline pipeline;
  
  NioPipelineTask(NioPipeline pipeline) { this.pipeline = pipeline; }
  
  public final void run() {
    if (this.pipeline.owner() == Thread.currentThread()) {
      try {
        run0();
      } catch (Exception e) {
        this.pipeline.onError(e);
      } 
    } else {
      this.pipeline.addTaskAndWakeup(this);
    } 
  }
  
  protected abstract void run0();
}
