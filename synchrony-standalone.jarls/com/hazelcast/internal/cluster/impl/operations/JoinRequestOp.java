package com.hazelcast.internal.cluster.impl.operations;

import com.hazelcast.internal.cluster.impl.ClusterServiceImpl;
import com.hazelcast.internal.cluster.impl.JoinRequest;
import com.hazelcast.nio.ObjectDataInput;
import com.hazelcast.nio.ObjectDataOutput;
import java.io.IOException;

public class JoinRequestOp extends AbstractClusterOperation {
  private JoinRequest request;
  
  public JoinRequestOp() {}
  
  public JoinRequestOp(JoinRequest request) { this.request = request; }
  
  public void run() {
    ClusterServiceImpl cm = (ClusterServiceImpl)getService();
    cm.getClusterJoinManager().handleJoinRequest(this.request, getConnection());
  }
  
  public JoinRequest getRequest() { return this.request; }
  
  protected void readInternal(ObjectDataInput in) throws IOException {
    this.request = new JoinRequest();
    this.request.readData(in);
  }
  
  protected void writeInternal(ObjectDataOutput out) throws IOException { this.request.writeData(out); }
  
  protected void toString(StringBuilder sb) {
    super.toString(sb);
    sb.append(", message=").append(this.request);
  }
  
  public int getId() { return 14; }
}
