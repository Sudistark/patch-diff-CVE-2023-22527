package com.hazelcast.internal.management.operation;

import com.hazelcast.config.WanReplicationConfig;
import com.hazelcast.nio.ObjectDataInput;
import com.hazelcast.nio.ObjectDataOutput;
import com.hazelcast.nio.serialization.impl.Versioned;
import java.io.IOException;

public class AddWanConfigLegacyOperation extends AbstractManagementOperation implements Versioned {
  private WanReplicationConfig wanReplicationConfig;
  
  public AddWanConfigLegacyOperation() {}
  
  public AddWanConfigLegacyOperation(WanReplicationConfig wanReplicationConfig) { this.wanReplicationConfig = wanReplicationConfig; }
  
  public void run() {
    getNodeEngine().getWanReplicationService()
      .addWanReplicationConfigLocally(this.wanReplicationConfig);
    getLogger().info("Appended WAN config with name " + this.wanReplicationConfig.getName());
  }
  
  protected void writeInternal(ObjectDataOutput out) throws IOException { this.wanReplicationConfig.writeData(out); }
  
  protected void readInternal(ObjectDataInput in) throws IOException {
    this.wanReplicationConfig = new WanReplicationConfig();
    this.wanReplicationConfig.readData(in);
  }
  
  public String getServiceName() { return "hz:core:wanReplicationService"; }
  
  public int getId() { return 4; }
}
