package com.hazelcast.internal.management.request;

import com.hazelcast.hotrestart.InternalHotRestartService;
import com.hazelcast.instance.Node;
import com.hazelcast.internal.json.JsonObject;
import com.hazelcast.internal.management.ManagementCenterService;

public class TriggerPartialStartRequest implements ConsoleRequest {
  public static final String SUCCESS_RESULT = "SUCCESS";
  
  public static final String FAILED_RESULT = "FAILED";
  
  public int getType() { return 39; }
  
  public void writeResponse(ManagementCenterService mcs, JsonObject out) throws Exception {
    Node node = (mcs.getHazelcastInstance()).node;
    InternalHotRestartService hotRestartService = node.getNodeExtension().getInternalHotRestartService();
    boolean done = hotRestartService.triggerPartialStart();
    String result = done ? "SUCCESS" : "FAILED";
    out.add("result", result);
  }
  
  public void fromJson(JsonObject json) {}
}
