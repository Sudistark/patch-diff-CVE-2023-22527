package com.hazelcast.internal.util.sort;

import com.hazelcast.internal.memory.MemoryAccessor;

public class IntMemArrayQuickSorter extends MemArrayQuickSorter {
  private int pivot;
  
  public IntMemArrayQuickSorter(MemoryAccessor mem, long baseAddress) { super(mem, baseAddress); }
  
  protected void loadPivot(long index) { this.pivot = intAtIndex(index); }
  
  protected boolean isLessThanPivot(long index) { return (intAtIndex(index) < this.pivot); }
  
  protected boolean isGreaterThanPivot(long index) { return (intAtIndex(index) > this.pivot); }
  
  protected void swap(long index1, long index2) {
    long addrOfIndex1 = addrOfIndex(index1);
    long addrOfIndex2 = addrOfIndex(index2);
    int tmp = intAtAddress(addrOfIndex1);
    this.mem.putInt(addrOfIndex1, intAtAddress(addrOfIndex2));
    this.mem.putInt(addrOfIndex2, tmp);
  }
  
  private long addrOfIndex(long index) { return this.baseAddress + 4L * index; }
  
  private int intAtIndex(long index) { return intAtAddress(addrOfIndex(index)); }
  
  private int intAtAddress(long address) { return this.mem.getInt(address); }
}
