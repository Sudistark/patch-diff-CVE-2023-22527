package com.hazelcast.topic.impl;

import com.hazelcast.spi.InternalCompletableFuture;
import com.hazelcast.spi.NodeEngine;
import com.hazelcast.spi.Operation;

public class TotalOrderedTopicProxy<E> extends TopicProxy<E> {
  private final int partitionId;
  
  public TotalOrderedTopicProxy(String name, NodeEngine nodeEngine, TopicService service) {
    super(name, nodeEngine, service);
    this.partitionId = nodeEngine.getPartitionService().getPartitionId(getNameAsPartitionAwareData());
  }
  
  public void publish(E message) {
    Operation operation = (new PublishOperation(getName(), toData(message))).setPartitionId(this.partitionId);
    InternalCompletableFuture f = invokeOnPartition(operation);
    f.join();
  }
}
