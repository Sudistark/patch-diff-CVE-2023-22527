package com.hazelcast.wan.impl;

import com.hazelcast.wan.ReplicationEventObject;
import com.hazelcast.wan.WanReplicationEndpoint;
import com.hazelcast.wan.WanReplicationEvent;
import com.hazelcast.wan.WanReplicationPublisher;

final class WanReplicationPublisherDelegate implements WanReplicationPublisher {
  final String name;
  
  final WanReplicationEndpoint[] endpoints;
  
  public WanReplicationPublisherDelegate(String name, WanReplicationEndpoint[] endpoints) {
    this.name = name;
    this.endpoints = endpoints;
  }
  
  public WanReplicationEndpoint[] getEndpoints() { return this.endpoints; }
  
  public String getName() { return this.name; }
  
  public void publishReplicationEvent(String serviceName, ReplicationEventObject eventObject) {
    for (WanReplicationEndpoint endpoint : this.endpoints)
      endpoint.publishReplicationEvent(serviceName, eventObject); 
  }
  
  public void publishReplicationEventBackup(String serviceName, ReplicationEventObject eventObject) {}
  
  public void publishReplicationEvent(WanReplicationEvent wanReplicationEvent) {}
  
  public void checkWanReplicationQueues() {
    for (WanReplicationEndpoint endpoint : this.endpoints)
      endpoint.checkWanReplicationQueues(); 
  }
}
