package com.hazelcast.query.impl;

import com.hazelcast.map.impl.MapDataSerializerHook;
import com.hazelcast.nio.ObjectDataInput;
import com.hazelcast.nio.ObjectDataOutput;
import com.hazelcast.nio.serialization.IdentifiedDataSerializable;
import java.io.IOException;
import java.util.Collection;
import java.util.LinkedList;
import java.util.List;

public class MapIndexInfo implements IdentifiedDataSerializable {
  private String mapName;
  
  private List<IndexInfo> indexInfos;
  
  public MapIndexInfo(String mapName) {
    this.indexInfos = new LinkedList();
    this.mapName = mapName;
  }
  
  public MapIndexInfo() { this.indexInfos = new LinkedList(); }
  
  public void addIndexInfo(String attributeName, boolean ordered) { this.indexInfos.add(new IndexInfo(attributeName, ordered)); }
  
  public void addIndexInfos(Collection<IndexInfo> indexInfos) { this.indexInfos.addAll(indexInfos); }
  
  public String getMapName() { return this.mapName; }
  
  public List<IndexInfo> getIndexInfos() { return this.indexInfos; }
  
  public void writeData(ObjectDataOutput out) throws IOException {
    out.writeUTF(this.mapName);
    out.writeInt(this.indexInfos.size());
    for (IndexInfo indexInfo : this.indexInfos)
      indexInfo.writeData(out); 
  }
  
  public void readData(ObjectDataInput in) throws IOException {
    this.mapName = in.readUTF();
    int size = in.readInt();
    for (int i = 0; i < size; i++) {
      IndexInfo indexInfo = new IndexInfo();
      indexInfo.readData(in);
      this.indexInfos.add(indexInfo);
    } 
  }
  
  public int getFactoryId() { return MapDataSerializerHook.F_ID; }
  
  public int getId() { return 99; }
}
