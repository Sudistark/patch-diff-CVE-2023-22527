package com.hazelcast.replicatedmap.impl.operation;

import com.hazelcast.replicatedmap.impl.record.ReplicatedRecordStore;
import com.hazelcast.spi.impl.MutatingOperation;
import com.hazelcast.util.scheduler.ScheduledEntry;
import java.util.Collection;

public class EvictionOperation extends AbstractNamedSerializableOperation implements MutatingOperation {
  private ReplicatedRecordStore store;
  
  private Collection<ScheduledEntry<Object, Object>> entries;
  
  public EvictionOperation() {}
  
  public EvictionOperation(ReplicatedRecordStore store, Collection<ScheduledEntry<Object, Object>> entries) {
    this.store = store;
    this.entries = entries;
  }
  
  public void run() {
    for (ScheduledEntry<Object, Object> entry : this.entries) {
      Object key = entry.getKey();
      this.store.evict(key);
    } 
  }
  
  public boolean validatesTarget() { return false; }
  
  public int getId() { return 16; }
  
  public String getName() { return this.store.getName(); }
}
