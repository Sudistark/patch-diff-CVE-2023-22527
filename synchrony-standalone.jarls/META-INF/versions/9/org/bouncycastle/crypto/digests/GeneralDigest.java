package META-INF.versions.9.org.bouncycastle.crypto.digests;

import org.bouncycastle.crypto.ExtendedDigest;
import org.bouncycastle.crypto.digests.GeneralDigest;
import org.bouncycastle.util.Memoable;
import org.bouncycastle.util.Pack;

public abstract class GeneralDigest implements ExtendedDigest, Memoable {
  private static final int BYTE_LENGTH = 64;
  
  private final byte[] xBuf = new byte[4];
  
  private int xBufOff;
  
  private long byteCount;
  
  protected GeneralDigest() { this.xBufOff = 0; }
  
  protected GeneralDigest(GeneralDigest paramGeneralDigest) { copyIn(paramGeneralDigest); }
  
  protected GeneralDigest(byte[] paramArrayOfByte) {
    System.arraycopy(paramArrayOfByte, 0, this.xBuf, 0, this.xBuf.length);
    this.xBufOff = Pack.bigEndianToInt(paramArrayOfByte, 4);
    this.byteCount = Pack.bigEndianToLong(paramArrayOfByte, 8);
  }
  
  protected void copyIn(GeneralDigest paramGeneralDigest) {
    System.arraycopy(paramGeneralDigest.xBuf, 0, this.xBuf, 0, paramGeneralDigest.xBuf.length);
    this.xBufOff = paramGeneralDigest.xBufOff;
    this.byteCount = paramGeneralDigest.byteCount;
  }
  
  public void update(byte paramByte) {
    this.xBuf[this.xBufOff++] = paramByte;
    if (this.xBufOff == this.xBuf.length) {
      processWord(this.xBuf, 0);
      this.xBufOff = 0;
    } 
    this.byteCount++;
  }
  
  public void update(byte[] paramArrayOfByte, int paramInt1, int paramInt2) {
    paramInt2 = Math.max(0, paramInt2);
    int i = 0;
    if (this.xBufOff != 0)
      while (i < paramInt2) {
        this.xBuf[this.xBufOff++] = paramArrayOfByte[paramInt1 + i++];
        if (this.xBufOff == 4) {
          processWord(this.xBuf, 0);
          this.xBufOff = 0;
          break;
        } 
      }  
    int j = (paramInt2 - i & 0xFFFFFFFC) + i;
    for (; i < j; i += 4)
      processWord(paramArrayOfByte, paramInt1 + i); 
    while (i < paramInt2)
      this.xBuf[this.xBufOff++] = paramArrayOfByte[paramInt1 + i++]; 
    this.byteCount += paramInt2;
  }
  
  public void finish() {
    long l = this.byteCount << 3;
    update(-128);
    while (this.xBufOff != 0)
      update((byte)0); 
    processLength(l);
    processBlock();
  }
  
  public void reset() {
    this.byteCount = 0L;
    this.xBufOff = 0;
    for (byte b = 0; b < this.xBuf.length; b++)
      this.xBuf[b] = 0; 
  }
  
  protected void populateState(byte[] paramArrayOfByte) {
    System.arraycopy(this.xBuf, 0, paramArrayOfByte, 0, this.xBufOff);
    Pack.intToBigEndian(this.xBufOff, paramArrayOfByte, 4);
    Pack.longToBigEndian(this.byteCount, paramArrayOfByte, 8);
  }
  
  public int getByteLength() { return 64; }
  
  protected abstract void processWord(byte[] paramArrayOfByte, int paramInt);
  
  protected abstract void processLength(long paramLong);
  
  protected abstract void processBlock();
}
