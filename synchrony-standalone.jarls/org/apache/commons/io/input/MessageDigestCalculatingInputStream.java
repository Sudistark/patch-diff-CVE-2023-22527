package org.apache.commons.io.input;

import java.io.InputStream;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;

public class MessageDigestCalculatingInputStream extends ObservableInputStream {
  private static final String DEFAULT_ALGORITHM = "MD5";
  
  private final MessageDigest messageDigest;
  
  public static Builder builder() { return new Builder(); }
  
  static MessageDigest getDefaultMessageDigest() throws NoSuchAlgorithmException { return MessageDigest.getInstance("MD5"); }
  
  @Deprecated
  public MessageDigestCalculatingInputStream(InputStream inputStream) throws NoSuchAlgorithmException { this(inputStream, getDefaultMessageDigest()); }
  
  @Deprecated
  public MessageDigestCalculatingInputStream(InputStream inputStream, MessageDigest messageDigest) {
    super(inputStream, new ObservableInputStream.Observer[] { new MessageDigestMaintainingObserver(messageDigest) });
    this.messageDigest = messageDigest;
  }
  
  @Deprecated
  public MessageDigestCalculatingInputStream(InputStream inputStream, String algorithm) throws NoSuchAlgorithmException { this(inputStream, MessageDigest.getInstance(algorithm)); }
  
  public MessageDigest getMessageDigest() throws NoSuchAlgorithmException { return this.messageDigest; }
}
