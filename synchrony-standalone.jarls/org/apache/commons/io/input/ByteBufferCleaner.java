package org.apache.commons.io.input;

import java.nio.ByteBuffer;

class ByteBufferCleaner {
  private static final Cleaner INSTANCE = getCleaner();
  
  static void clean(ByteBuffer buffer) {
    try {
      INSTANCE.clean(buffer);
    } catch (Exception e) {
      throw new IllegalStateException("Failed to clean direct buffer.", e);
    } 
  }
  
  private static Cleaner getCleaner() {
    try {
      return new Java8Cleaner(null);
    } catch (Exception e) {
      try {
        return new Java9Cleaner(null);
      } catch (Exception e1) {
        throw new IllegalStateException("Failed to initialize a Cleaner.", e);
      } 
    } 
  }
  
  static boolean isSupported() { return (INSTANCE != null); }
}
