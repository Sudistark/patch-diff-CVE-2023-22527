package org.apache.commons.compress.java.util.jar;

import java.security.AccessController;
import org.apache.commons.compress.harmony.archive.internal.nls.Messages;

public abstract class Pack200 {
  private static final String SYSTEM_PROPERTY_PACKER = "java.util.jar.Pack200.Packer";
  
  private static final String SYSTEM_PROPERTY_UNPACKER = "java.util.jar.Pack200.Unpacker";
  
  static Object newInstance(String systemProperty, String defaultClassName) {
    return AccessController.doPrivileged(() -> {
          String className = System.getProperty(systemProperty, defaultClassName);
          try {
            return Pack200.class.getClassLoader().loadClass(className).newInstance();
          } catch (Exception e) {
            throw new Error(Messages.getString("archive.3E", className), e);
          } 
        });
  }
  
  public static Packer newPacker() { return (Packer)newInstance("java.util.jar.Pack200.Packer", "org.apache.commons.compress.harmony.pack200.Pack200PackerAdapter"); }
  
  public static Unpacker newUnpacker() { return (Unpacker)newInstance("java.util.jar.Pack200.Unpacker", "org.apache.commons.compress.harmony.unpack200.Pack200UnpackerAdapter"); }
}
