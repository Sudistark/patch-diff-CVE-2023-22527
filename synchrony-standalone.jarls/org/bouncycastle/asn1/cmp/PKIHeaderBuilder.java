package org.bouncycastle.asn1.cmp;

import org.bouncycastle.asn1.ASN1Encodable;
import org.bouncycastle.asn1.ASN1EncodableVector;
import org.bouncycastle.asn1.ASN1GeneralizedTime;
import org.bouncycastle.asn1.ASN1Integer;
import org.bouncycastle.asn1.ASN1OctetString;
import org.bouncycastle.asn1.ASN1Sequence;
import org.bouncycastle.asn1.DEROctetString;
import org.bouncycastle.asn1.DERSequence;
import org.bouncycastle.asn1.DERTaggedObject;
import org.bouncycastle.asn1.x509.AlgorithmIdentifier;
import org.bouncycastle.asn1.x509.GeneralName;

public class PKIHeaderBuilder {
  private ASN1Integer pvno;
  
  private GeneralName sender;
  
  private GeneralName recipient;
  
  private ASN1GeneralizedTime messageTime;
  
  private AlgorithmIdentifier protectionAlg;
  
  private ASN1OctetString senderKID;
  
  private ASN1OctetString recipKID;
  
  private ASN1OctetString transactionID;
  
  private ASN1OctetString senderNonce;
  
  private ASN1OctetString recipNonce;
  
  private PKIFreeText freeText;
  
  private ASN1Sequence generalInfo;
  
  public PKIHeaderBuilder(int paramInt, GeneralName paramGeneralName1, GeneralName paramGeneralName2) { this(new ASN1Integer(paramInt), paramGeneralName1, paramGeneralName2); }
  
  private PKIHeaderBuilder(ASN1Integer paramASN1Integer, GeneralName paramGeneralName1, GeneralName paramGeneralName2) {
    this.pvno = paramASN1Integer;
    this.sender = paramGeneralName1;
    this.recipient = paramGeneralName2;
  }
  
  public PKIHeaderBuilder setMessageTime(ASN1GeneralizedTime paramASN1GeneralizedTime) {
    this.messageTime = paramASN1GeneralizedTime;
    return this;
  }
  
  public PKIHeaderBuilder setProtectionAlg(AlgorithmIdentifier paramAlgorithmIdentifier) {
    this.protectionAlg = paramAlgorithmIdentifier;
    return this;
  }
  
  public PKIHeaderBuilder setSenderKID(byte[] paramArrayOfByte) { return setSenderKID((paramArrayOfByte == null) ? null : new DEROctetString(paramArrayOfByte)); }
  
  public PKIHeaderBuilder setSenderKID(ASN1OctetString paramASN1OctetString) {
    this.senderKID = paramASN1OctetString;
    return this;
  }
  
  public PKIHeaderBuilder setRecipKID(byte[] paramArrayOfByte) { return setRecipKID((paramArrayOfByte == null) ? null : new DEROctetString(paramArrayOfByte)); }
  
  public PKIHeaderBuilder setRecipKID(ASN1OctetString paramASN1OctetString) {
    this.recipKID = paramASN1OctetString;
    return this;
  }
  
  public PKIHeaderBuilder setTransactionID(byte[] paramArrayOfByte) { return setTransactionID((paramArrayOfByte == null) ? null : new DEROctetString(paramArrayOfByte)); }
  
  public PKIHeaderBuilder setTransactionID(ASN1OctetString paramASN1OctetString) {
    this.transactionID = paramASN1OctetString;
    return this;
  }
  
  public PKIHeaderBuilder setSenderNonce(byte[] paramArrayOfByte) { return setSenderNonce((paramArrayOfByte == null) ? null : new DEROctetString(paramArrayOfByte)); }
  
  public PKIHeaderBuilder setSenderNonce(ASN1OctetString paramASN1OctetString) {
    this.senderNonce = paramASN1OctetString;
    return this;
  }
  
  public PKIHeaderBuilder setRecipNonce(byte[] paramArrayOfByte) { return setRecipNonce((paramArrayOfByte == null) ? null : new DEROctetString(paramArrayOfByte)); }
  
  public PKIHeaderBuilder setRecipNonce(ASN1OctetString paramASN1OctetString) {
    this.recipNonce = paramASN1OctetString;
    return this;
  }
  
  public PKIHeaderBuilder setFreeText(PKIFreeText paramPKIFreeText) {
    this.freeText = paramPKIFreeText;
    return this;
  }
  
  public PKIHeaderBuilder setGeneralInfo(InfoTypeAndValue paramInfoTypeAndValue) { return setGeneralInfo(makeGeneralInfoSeq(paramInfoTypeAndValue)); }
  
  public PKIHeaderBuilder setGeneralInfo(InfoTypeAndValue[] paramArrayOfInfoTypeAndValue) { return setGeneralInfo(makeGeneralInfoSeq(paramArrayOfInfoTypeAndValue)); }
  
  public PKIHeaderBuilder setGeneralInfo(ASN1Sequence paramASN1Sequence) {
    this.generalInfo = paramASN1Sequence;
    return this;
  }
  
  private static ASN1Sequence makeGeneralInfoSeq(InfoTypeAndValue paramInfoTypeAndValue) { return new DERSequence(paramInfoTypeAndValue); }
  
  private static ASN1Sequence makeGeneralInfoSeq(InfoTypeAndValue[] paramArrayOfInfoTypeAndValue) {
    DERSequence dERSequence = null;
    if (paramArrayOfInfoTypeAndValue != null)
      dERSequence = new DERSequence(paramArrayOfInfoTypeAndValue); 
    return dERSequence;
  }
  
  public PKIHeader build() {
    ASN1EncodableVector aSN1EncodableVector = new ASN1EncodableVector(12);
    aSN1EncodableVector.add(this.pvno);
    aSN1EncodableVector.add(this.sender);
    aSN1EncodableVector.add(this.recipient);
    addOptional(aSN1EncodableVector, 0, this.messageTime);
    addOptional(aSN1EncodableVector, 1, this.protectionAlg);
    addOptional(aSN1EncodableVector, 2, this.senderKID);
    addOptional(aSN1EncodableVector, 3, this.recipKID);
    addOptional(aSN1EncodableVector, 4, this.transactionID);
    addOptional(aSN1EncodableVector, 5, this.senderNonce);
    addOptional(aSN1EncodableVector, 6, this.recipNonce);
    addOptional(aSN1EncodableVector, 7, this.freeText);
    addOptional(aSN1EncodableVector, 8, this.generalInfo);
    this.messageTime = null;
    this.protectionAlg = null;
    this.senderKID = null;
    this.recipKID = null;
    this.transactionID = null;
    this.senderNonce = null;
    this.recipNonce = null;
    this.freeText = null;
    this.generalInfo = null;
    return PKIHeader.getInstance(new DERSequence(aSN1EncodableVector));
  }
  
  private void addOptional(ASN1EncodableVector paramASN1EncodableVector, int paramInt, ASN1Encodable paramASN1Encodable) {
    if (paramASN1Encodable != null)
      paramASN1EncodableVector.add(new DERTaggedObject(true, paramInt, paramASN1Encodable)); 
  }
}
