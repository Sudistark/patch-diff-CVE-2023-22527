package org.bouncycastle.mail.smime.examples;

import java.io.FileOutputStream;
import java.util.Properties;
import javax.mail.Message;
import javax.mail.Session;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import org.bouncycastle.cms.jcajce.ZlibCompressor;
import org.bouncycastle.mail.smime.SMIMECompressedGenerator;

public class CreateCompressedMail {
  public static void main(String[] paramArrayOfString) throws Exception {
    SMIMECompressedGenerator sMIMECompressedGenerator = new SMIMECompressedGenerator();
    MimeBodyPart mimeBodyPart1 = new MimeBodyPart();
    mimeBodyPart1.setText("Hello world!");
    MimeBodyPart mimeBodyPart2 = sMIMECompressedGenerator.generate(mimeBodyPart1, new ZlibCompressor());
    Properties properties = System.getProperties();
    Session session = Session.getDefaultInstance(properties, null);
    InternetAddress internetAddress1 = new InternetAddress("\"Eric H. Echidna\"<eric@bouncycastle.org>");
    InternetAddress internetAddress2 = new InternetAddress("example@bouncycastle.org");
    MimeMessage mimeMessage = new MimeMessage(session);
    mimeMessage.setFrom(internetAddress1);
    mimeMessage.setRecipient(Message.RecipientType.TO, internetAddress2);
    mimeMessage.setSubject("example compressed message");
    mimeMessage.setContent(mimeBodyPart2.getContent(), mimeBodyPart2.getContentType());
    mimeMessage.saveChanges();
    mimeMessage.writeTo(new FileOutputStream("compressed.message"));
  }
}
