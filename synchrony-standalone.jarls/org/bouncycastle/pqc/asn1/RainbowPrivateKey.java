package org.bouncycastle.pqc.asn1;

import org.bouncycastle.asn1.ASN1EncodableVector;
import org.bouncycastle.asn1.ASN1Integer;
import org.bouncycastle.asn1.ASN1Object;
import org.bouncycastle.asn1.ASN1ObjectIdentifier;
import org.bouncycastle.asn1.ASN1OctetString;
import org.bouncycastle.asn1.ASN1Primitive;
import org.bouncycastle.asn1.ASN1Sequence;
import org.bouncycastle.asn1.DEROctetString;
import org.bouncycastle.asn1.DERSequence;
import org.bouncycastle.pqc.crypto.rainbow.Layer;
import org.bouncycastle.pqc.crypto.rainbow.util.RainbowUtil;

public class RainbowPrivateKey extends ASN1Object {
  private ASN1Integer version;
  
  private ASN1ObjectIdentifier oid;
  
  private byte[][] invA1;
  
  private byte[] b1;
  
  private byte[][] invA2;
  
  private byte[] b2;
  
  private byte[] vi;
  
  private Layer[] layers;
  
  private RainbowPrivateKey(ASN1Sequence paramASN1Sequence) {
    if (paramASN1Sequence.getObjectAt(0) instanceof ASN1Integer) {
      this.version = ASN1Integer.getInstance(paramASN1Sequence.getObjectAt(0));
    } else {
      this.oid = ASN1ObjectIdentifier.getInstance(paramASN1Sequence.getObjectAt(0));
    } 
    ASN1Sequence aSN1Sequence1 = (ASN1Sequence)paramASN1Sequence.getObjectAt(1);
    this.invA1 = new byte[aSN1Sequence1.size()][];
    for (byte b3 = 0; b3 < aSN1Sequence1.size(); b3++)
      this.invA1[b3] = ((ASN1OctetString)aSN1Sequence1.getObjectAt(b3)).getOctets(); 
    ASN1Sequence aSN1Sequence2 = (ASN1Sequence)paramASN1Sequence.getObjectAt(2);
    this.b1 = ((ASN1OctetString)aSN1Sequence2.getObjectAt(0)).getOctets();
    ASN1Sequence aSN1Sequence3 = (ASN1Sequence)paramASN1Sequence.getObjectAt(3);
    this.invA2 = new byte[aSN1Sequence3.size()][];
    for (byte b4 = 0; b4 < aSN1Sequence3.size(); b4++)
      this.invA2[b4] = ((ASN1OctetString)aSN1Sequence3.getObjectAt(b4)).getOctets(); 
    ASN1Sequence aSN1Sequence4 = (ASN1Sequence)paramASN1Sequence.getObjectAt(4);
    this.b2 = ((ASN1OctetString)aSN1Sequence4.getObjectAt(0)).getOctets();
    ASN1Sequence aSN1Sequence5 = (ASN1Sequence)paramASN1Sequence.getObjectAt(5);
    this.vi = ((ASN1OctetString)aSN1Sequence5.getObjectAt(0)).getOctets();
    ASN1Sequence aSN1Sequence6 = (ASN1Sequence)paramASN1Sequence.getObjectAt(6);
    byte[][][][] arrayOfByte1 = new byte[aSN1Sequence6.size()][][][];
    byte[][][][] arrayOfByte2 = new byte[aSN1Sequence6.size()][][][];
    byte[][][] arrayOfByte = new byte[aSN1Sequence6.size()][][];
    byte[][] arrayOfByte3 = new byte[aSN1Sequence6.size()][];
    int i;
    for (i = 0; i < aSN1Sequence6.size(); i++) {
      ASN1Sequence aSN1Sequence7 = (ASN1Sequence)aSN1Sequence6.getObjectAt(i);
      ASN1Sequence aSN1Sequence8 = (ASN1Sequence)aSN1Sequence7.getObjectAt(0);
      arrayOfByte1[i] = new byte[aSN1Sequence8.size()][][];
      for (byte b6 = 0; b6 < aSN1Sequence8.size(); b6++) {
        ASN1Sequence aSN1Sequence = (ASN1Sequence)aSN1Sequence8.getObjectAt(b6);
        arrayOfByte1[i][b6] = new byte[aSN1Sequence.size()][];
        for (byte b = 0; b < aSN1Sequence.size(); b++)
          arrayOfByte1[i][b6][b] = ((ASN1OctetString)aSN1Sequence.getObjectAt(b)).getOctets(); 
      } 
      ASN1Sequence aSN1Sequence9 = (ASN1Sequence)aSN1Sequence7.getObjectAt(1);
      arrayOfByte2[i] = new byte[aSN1Sequence9.size()][][];
      for (byte b7 = 0; b7 < aSN1Sequence9.size(); b7++) {
        ASN1Sequence aSN1Sequence = (ASN1Sequence)aSN1Sequence9.getObjectAt(b7);
        arrayOfByte2[i][b7] = new byte[aSN1Sequence.size()][];
        for (byte b = 0; b < aSN1Sequence.size(); b++)
          arrayOfByte2[i][b7][b] = ((ASN1OctetString)aSN1Sequence.getObjectAt(b)).getOctets(); 
      } 
      ASN1Sequence aSN1Sequence10 = (ASN1Sequence)aSN1Sequence7.getObjectAt(2);
      arrayOfByte[i] = new byte[aSN1Sequence10.size()][];
      for (byte b8 = 0; b8 < aSN1Sequence10.size(); b8++)
        arrayOfByte[i][b8] = ((ASN1OctetString)aSN1Sequence10.getObjectAt(b8)).getOctets(); 
      arrayOfByte3[i] = ((ASN1OctetString)aSN1Sequence7.getObjectAt(3)).getOctets();
    } 
    i = this.vi.length - 1;
    this.layers = new Layer[i];
    for (byte b5 = 0; b5 < i; b5++) {
      Layer layer = new Layer(this.vi[b5], this.vi[b5 + true], RainbowUtil.convertArray(arrayOfByte1[b5]), RainbowUtil.convertArray(arrayOfByte2[b5]), RainbowUtil.convertArray(arrayOfByte[b5]), RainbowUtil.convertArray(arrayOfByte3[b5]));
      this.layers[b5] = layer;
    } 
  }
  
  public RainbowPrivateKey(short[][] paramArrayOfShort1, short[] paramArrayOfShort2, short[][] paramArrayOfShort3, short[] paramArrayOfShort4, int[] paramArrayOfInt, Layer[] paramArrayOfLayer) {
    this.version = new ASN1Integer(1L);
    this.invA1 = RainbowUtil.convertArray(paramArrayOfShort1);
    this.b1 = RainbowUtil.convertArray(paramArrayOfShort2);
    this.invA2 = RainbowUtil.convertArray(paramArrayOfShort3);
    this.b2 = RainbowUtil.convertArray(paramArrayOfShort4);
    this.vi = RainbowUtil.convertIntArray(paramArrayOfInt);
    this.layers = paramArrayOfLayer;
  }
  
  public static RainbowPrivateKey getInstance(Object paramObject) { return (paramObject instanceof RainbowPrivateKey) ? (RainbowPrivateKey)paramObject : ((paramObject != null) ? new RainbowPrivateKey(ASN1Sequence.getInstance(paramObject)) : null); }
  
  public ASN1Integer getVersion() { return this.version; }
  
  public short[][] getInvA1() { return RainbowUtil.convertArray(this.invA1); }
  
  public short[] getB1() { return RainbowUtil.convertArray(this.b1); }
  
  public short[] getB2() { return RainbowUtil.convertArray(this.b2); }
  
  public short[][] getInvA2() { return RainbowUtil.convertArray(this.invA2); }
  
  public Layer[] getLayers() { return this.layers; }
  
  public int[] getVi() { return RainbowUtil.convertArraytoInt(this.vi); }
  
  public ASN1Primitive toASN1Primitive() {
    ASN1EncodableVector aSN1EncodableVector1 = new ASN1EncodableVector();
    if (this.version != null) {
      aSN1EncodableVector1.add(this.version);
    } else {
      aSN1EncodableVector1.add(this.oid);
    } 
    ASN1EncodableVector aSN1EncodableVector2 = new ASN1EncodableVector();
    for (byte b3 = 0; b3 < this.invA1.length; b3++)
      aSN1EncodableVector2.add(new DEROctetString(this.invA1[b3])); 
    aSN1EncodableVector1.add(new DERSequence(aSN1EncodableVector2));
    ASN1EncodableVector aSN1EncodableVector3 = new ASN1EncodableVector();
    aSN1EncodableVector3.add(new DEROctetString(this.b1));
    aSN1EncodableVector1.add(new DERSequence(aSN1EncodableVector3));
    ASN1EncodableVector aSN1EncodableVector4 = new ASN1EncodableVector();
    for (byte b4 = 0; b4 < this.invA2.length; b4++)
      aSN1EncodableVector4.add(new DEROctetString(this.invA2[b4])); 
    aSN1EncodableVector1.add(new DERSequence(aSN1EncodableVector4));
    ASN1EncodableVector aSN1EncodableVector5 = new ASN1EncodableVector();
    aSN1EncodableVector5.add(new DEROctetString(this.b2));
    aSN1EncodableVector1.add(new DERSequence(aSN1EncodableVector5));
    ASN1EncodableVector aSN1EncodableVector6 = new ASN1EncodableVector();
    aSN1EncodableVector6.add(new DEROctetString(this.vi));
    aSN1EncodableVector1.add(new DERSequence(aSN1EncodableVector6));
    ASN1EncodableVector aSN1EncodableVector7 = new ASN1EncodableVector();
    for (byte b5 = 0; b5 < this.layers.length; b5++) {
      ASN1EncodableVector aSN1EncodableVector8 = new ASN1EncodableVector();
      byte[][][] arrayOfByte1 = RainbowUtil.convertArray(this.layers[b5].getCoeffAlpha());
      ASN1EncodableVector aSN1EncodableVector9 = new ASN1EncodableVector();
      for (byte b6 = 0; b6 < arrayOfByte1.length; b6++) {
        ASN1EncodableVector aSN1EncodableVector = new ASN1EncodableVector();
        for (byte b = 0; b < arrayOfByte1[b6].length; b++)
          aSN1EncodableVector.add(new DEROctetString(arrayOfByte1[b6][b])); 
        aSN1EncodableVector9.add(new DERSequence(aSN1EncodableVector));
      } 
      aSN1EncodableVector8.add(new DERSequence(aSN1EncodableVector9));
      byte[][][] arrayOfByte2 = RainbowUtil.convertArray(this.layers[b5].getCoeffBeta());
      ASN1EncodableVector aSN1EncodableVector10 = new ASN1EncodableVector();
      for (byte b7 = 0; b7 < arrayOfByte2.length; b7++) {
        ASN1EncodableVector aSN1EncodableVector = new ASN1EncodableVector();
        for (byte b = 0; b < arrayOfByte2[b7].length; b++)
          aSN1EncodableVector.add(new DEROctetString(arrayOfByte2[b7][b])); 
        aSN1EncodableVector10.add(new DERSequence(aSN1EncodableVector));
      } 
      aSN1EncodableVector8.add(new DERSequence(aSN1EncodableVector10));
      byte[][] arrayOfByte = RainbowUtil.convertArray(this.layers[b5].getCoeffGamma());
      ASN1EncodableVector aSN1EncodableVector11 = new ASN1EncodableVector();
      for (byte b8 = 0; b8 < arrayOfByte.length; b8++)
        aSN1EncodableVector11.add(new DEROctetString(arrayOfByte[b8])); 
      aSN1EncodableVector8.add(new DERSequence(aSN1EncodableVector11));
      aSN1EncodableVector8.add(new DEROctetString(RainbowUtil.convertArray(this.layers[b5].getCoeffEta())));
      aSN1EncodableVector7.add(new DERSequence(aSN1EncodableVector8));
    } 
    aSN1EncodableVector1.add(new DERSequence(aSN1EncodableVector7));
    return new DERSequence(aSN1EncodableVector1);
  }
}
