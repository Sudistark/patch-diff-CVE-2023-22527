package org.bouncycastle.pqc.crypto.lms;

import java.io.IOException;
import org.bouncycastle.crypto.CipherParameters;
import org.bouncycastle.pqc.crypto.MessageSigner;

public class HSSSigner implements MessageSigner {
  private HSSPrivateKeyParameters privKey;
  
  private HSSPublicKeyParameters pubKey;
  
  public void init(boolean paramBoolean, CipherParameters paramCipherParameters) {
    if (paramBoolean) {
      this.privKey = (HSSPrivateKeyParameters)paramCipherParameters;
    } else {
      this.pubKey = (HSSPublicKeyParameters)paramCipherParameters;
    } 
  }
  
  public byte[] generateSignature(byte[] paramArrayOfByte) {
    try {
      return HSS.generateSignature(this.privKey, paramArrayOfByte).getEncoded();
    } catch (IOException iOException) {
      throw new IllegalStateException("unable to encode signature: " + iOException.getMessage());
    } 
  }
  
  public boolean verifySignature(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    try {
      return HSS.verifySignature(this.pubKey, HSSSignature.getInstance(paramArrayOfByte2, this.pubKey.getL()), paramArrayOfByte1);
    } catch (IOException iOException) {
      throw new IllegalStateException("unable to decode signature: " + iOException.getMessage());
    } 
  }
}
