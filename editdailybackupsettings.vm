#* @vtlvariable name="action" type="com.atlassian.confluence.admin.actions.DailyBackupAdminAction" *#
<html>
	<head>
		<title>$action.getText("daily.backup.action.name")</title>
        <meta name="help-path" content="/admin/help/dailybackup.vm"/>
        #requireResource("confluence.web.resources:backupadmin")
        #requireResource("confluence.web.resources:aui-forms")
	</head>
    <content tag="selectedWebItem">dailybackup</content>
    <content tag="subtitleDescription">daily.backup.subtitle</content>
	<body>
		#parse ( "/template/includes/actionerrors.vm" )

        #applyDecorator("form-aui")
            #decoratorParam("editMode" $editMode)
            #decoratorParam("formName" "dailybackup")
            #decoratorParam("submitAction" "doeditdailybackupsettings.action")
            #decoratorParam("editAction" "editdailybackupsettings.action")
            #decoratorParam("formStyle" "long-label")

            #form_xsrfToken()
            <h2>$action.getText("backup.settings.form.heading")</h2>

            #if (!$action.editMode)
                #applyDecorator ("message")
                    #decoratorParam("type" "warning")
                    $action.getText('backup.warning', [$docBean.getLink("help.configuring.daily.backups")])
                #end
                #set ($jobActionPath = "$req.contextPath/admin/scheduledjobs/viewscheduledjobs.action")
                #stextfield("label='backup.daily.on'" "name='dailyBackupStatus'" "theme='aui'" "value=#if($action.backupEnabled)'Enabled'#else'Disabled'#end"
                            "description=$action.getText('backup.disable.tip', [$jobActionPath])")
                #stextfield("label='backup.file.pattern'" "name='dailyBackupFilePrefixPreview'" "theme='aui'" "value=dailyBackupFilePrefixWithDatePattern")
            #end
            #stextfield("label='backup.file.prefix'" "name='dailyBackupFilePrefix'" "theme='aui'")
            #stextfield("label='backup.file.date.pattern'" "name='dailyBackupDateFormatPattern'" "theme='aui'")

            #if (!$action.customLocationAllowed)
                <input type="hidden" name="backupOption" value="default"/>
                #set( $backupDescription = "$action.getText('custom.backup.path.disabled') #doc('help.configuring.daily.backup.path' $action.getText('custom.backup.path.help'))")
                #stextfield("label='backup.path'" "name='backup'" "value='$action.defaultBackupPath'" "theme='aui'"
                            "disabled=true"
                            "description=$backupDescription")
            #else
                #if ($action.editMode)
                    <input type="hidden" id="defaultPath" value="$action.defaultBackupPath"/>
                    #sradio("label='backup.path'" "list=backupOptions" "value=backupOption" "name='backupOption'" "listKey=key" "listValue=value" "theme='aui'" "template='radiolist.vm'")
                        #if ($action.backupOption == 'default')
                    #stextfield("name='backupPath'" "theme='aui'"
                                "description=$action.getText('backup.path.text.description')"
                                "fieldGroupId=backupPathBox"
                                "disabled=true")
                    #end

                #else
                    #stextfield("label='backup.path'" "value=backupPath" "theme='aui'")
                #end
            #end
            #scomponent("label='backup.attachments'" "name='backupAttachments'" "value=backupAttachments" "theme='aui'" "template='onofflist.vm'")
            #end

            #ssubmit("theme='aui'"
                     "editMode=$action.editMode")
        #end

		#parse("/breadcrumbs.vm")
	</body>
</html>
