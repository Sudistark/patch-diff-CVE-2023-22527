package io.netty.handler.pcap;

import io.netty.buffer.ByteBuf;

final class TCPPacket {
  private static final short OFFSET = 20480;
  
  static void writePacket(ByteBuf byteBuf, ByteBuf payload, int segmentNumber, int ackNumber, int srcPort, int dstPort, TCPFlag... tcpFlags) {
    byteBuf.writeShort(srcPort);
    byteBuf.writeShort(dstPort);
    byteBuf.writeInt(segmentNumber);
    byteBuf.writeInt(ackNumber);
    byteBuf.writeShort(0x5000 | TCPFlag.getFlag(tcpFlags));
    byteBuf.writeShort(65535);
    byteBuf.writeShort(1);
    byteBuf.writeShort(0);
    if (payload != null)
      byteBuf.writeBytes(payload); 
  }
}
