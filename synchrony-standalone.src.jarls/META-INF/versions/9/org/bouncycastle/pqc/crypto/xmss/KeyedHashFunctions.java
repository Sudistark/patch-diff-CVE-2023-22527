package META-INF.versions.9.org.bouncycastle.pqc.crypto.xmss;

import org.bouncycastle.asn1.ASN1ObjectIdentifier;
import org.bouncycastle.crypto.Digest;
import org.bouncycastle.crypto.Xof;
import org.bouncycastle.pqc.crypto.xmss.DigestUtil;
import org.bouncycastle.pqc.crypto.xmss.KeyedHashFunctions;
import org.bouncycastle.pqc.crypto.xmss.XMSSUtil;

final class KeyedHashFunctions {
  private final Digest digest;
  
  private final int digestSize;
  
  protected KeyedHashFunctions(ASN1ObjectIdentifier paramASN1ObjectIdentifier, int paramInt) {
    if (paramASN1ObjectIdentifier == null)
      throw new NullPointerException("digest == null"); 
    this.digest = DigestUtil.getDigest(paramASN1ObjectIdentifier);
    this.digestSize = paramInt;
  }
  
  private byte[] coreDigest(int paramInt, byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    byte[] arrayOfByte1 = XMSSUtil.toBytesBigEndian(paramInt, this.digestSize);
    this.digest.update(arrayOfByte1, 0, arrayOfByte1.length);
    this.digest.update(paramArrayOfByte1, 0, paramArrayOfByte1.length);
    this.digest.update(paramArrayOfByte2, 0, paramArrayOfByte2.length);
    byte[] arrayOfByte2 = new byte[this.digestSize];
    if (this.digest instanceof Xof) {
      ((Xof)this.digest).doFinal(arrayOfByte2, 0, this.digestSize);
    } else {
      this.digest.doFinal(arrayOfByte2, 0);
    } 
    return arrayOfByte2;
  }
  
  protected byte[] F(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    if (paramArrayOfByte1.length != this.digestSize)
      throw new IllegalArgumentException("wrong key length"); 
    if (paramArrayOfByte2.length != this.digestSize)
      throw new IllegalArgumentException("wrong in length"); 
    return coreDigest(0, paramArrayOfByte1, paramArrayOfByte2);
  }
  
  protected byte[] H(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    if (paramArrayOfByte1.length != this.digestSize)
      throw new IllegalArgumentException("wrong key length"); 
    if (paramArrayOfByte2.length != 2 * this.digestSize)
      throw new IllegalArgumentException("wrong in length"); 
    return coreDigest(1, paramArrayOfByte1, paramArrayOfByte2);
  }
  
  protected byte[] HMsg(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    if (paramArrayOfByte1.length != 3 * this.digestSize)
      throw new IllegalArgumentException("wrong key length"); 
    return coreDigest(2, paramArrayOfByte1, paramArrayOfByte2);
  }
  
  protected byte[] PRF(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    if (paramArrayOfByte1.length != this.digestSize)
      throw new IllegalArgumentException("wrong key length"); 
    if (paramArrayOfByte2.length != 32)
      throw new IllegalArgumentException("wrong address length"); 
    return coreDigest(3, paramArrayOfByte1, paramArrayOfByte2);
  }
}
