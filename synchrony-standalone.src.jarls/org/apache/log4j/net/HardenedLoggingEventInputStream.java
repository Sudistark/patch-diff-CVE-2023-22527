package org.apache.log4j.net;

import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;

public class HardenedLoggingEventInputStream extends HardenedObjectInputStream {
  static final String ARRAY_PREFIX = "[L";
  
  public static List<String> getWhilelist() {
    whitelist = new ArrayList();
    whitelist.add(org.apache.log4j.spi.LoggingEvent.class.getName());
    whitelist.add(org.apache.log4j.Level.class.getName());
    whitelist.add(org.apache.log4j.Priority.class.getName());
    whitelist.add(org.apache.log4j.spi.ThrowableInformation.class.getName());
    whitelist.add(org.apache.log4j.spi.LocationInfo.class.getName());
    return whitelist;
  }
  
  public HardenedLoggingEventInputStream(InputStream is) throws IOException { super(is, getWhilelist()); }
  
  public HardenedLoggingEventInputStream(InputStream is, List<String> additionalAuthorizedClasses) throws IOException {
    this(is);
    addToWhitelist(additionalAuthorizedClasses);
  }
}
