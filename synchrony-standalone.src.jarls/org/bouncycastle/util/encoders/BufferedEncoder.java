package org.bouncycastle.util.encoders;

public class BufferedEncoder {
  protected byte[] buf;
  
  protected int bufOff;
  
  protected Translator translator;
  
  public BufferedEncoder(Translator paramTranslator, int paramInt) {
    this.translator = paramTranslator;
    if (paramInt % paramTranslator.getEncodedBlockSize() != 0)
      throw new IllegalArgumentException("buffer size not multiple of input block size"); 
    this.buf = new byte[paramInt];
    this.bufOff = 0;
  }
  
  public int processByte(byte paramByte, byte[] paramArrayOfByte, int paramInt) {
    int i = 0;
    this.buf[this.bufOff++] = paramByte;
    if (this.bufOff == this.buf.length) {
      i = this.translator.encode(this.buf, 0, this.buf.length, paramArrayOfByte, paramInt);
      this.bufOff = 0;
    } 
    return i;
  }
  
  public int processBytes(byte[] paramArrayOfByte1, int paramInt1, int paramInt2, byte[] paramArrayOfByte2, int paramInt3) {
    if (paramInt2 < 0)
      throw new IllegalArgumentException("Can't have a negative input length!"); 
    int i = 0;
    int j = this.buf.length - this.bufOff;
    if (paramInt2 > j) {
      System.arraycopy(paramArrayOfByte1, paramInt1, this.buf, this.bufOff, j);
      i += this.translator.encode(this.buf, 0, this.buf.length, paramArrayOfByte2, paramInt3);
      this.bufOff = 0;
      paramInt2 -= j;
      paramInt1 += j;
      paramInt3 += i;
      int k = paramInt2 - paramInt2 % this.buf.length;
      i += this.translator.encode(paramArrayOfByte1, paramInt1, k, paramArrayOfByte2, paramInt3);
      paramInt2 -= k;
      paramInt1 += k;
    } 
    if (paramInt2 != 0) {
      System.arraycopy(paramArrayOfByte1, paramInt1, this.buf, this.bufOff, paramInt2);
      this.bufOff += paramInt2;
    } 
    return i;
  }
}
