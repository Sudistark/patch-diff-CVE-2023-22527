package org.bouncycastle.math.ec;

import java.math.BigInteger;
import org.bouncycastle.util.BigIntegers;

public abstract class ECFieldElement implements ECConstants {
  public abstract BigInteger toBigInteger();
  
  public abstract String getFieldName();
  
  public abstract int getFieldSize();
  
  public abstract ECFieldElement add(ECFieldElement paramECFieldElement);
  
  public abstract ECFieldElement addOne();
  
  public abstract ECFieldElement subtract(ECFieldElement paramECFieldElement);
  
  public abstract ECFieldElement multiply(ECFieldElement paramECFieldElement);
  
  public abstract ECFieldElement divide(ECFieldElement paramECFieldElement);
  
  public abstract ECFieldElement negate();
  
  public abstract ECFieldElement square();
  
  public abstract ECFieldElement invert();
  
  public abstract ECFieldElement sqrt();
  
  public int bitLength() { return toBigInteger().bitLength(); }
  
  public boolean isOne() { return (bitLength() == 1); }
  
  public boolean isZero() { return (0 == toBigInteger().signum()); }
  
  public ECFieldElement multiplyMinusProduct(ECFieldElement paramECFieldElement1, ECFieldElement paramECFieldElement2, ECFieldElement paramECFieldElement3) { return multiply(paramECFieldElement1).subtract(paramECFieldElement2.multiply(paramECFieldElement3)); }
  
  public ECFieldElement multiplyPlusProduct(ECFieldElement paramECFieldElement1, ECFieldElement paramECFieldElement2, ECFieldElement paramECFieldElement3) { return multiply(paramECFieldElement1).add(paramECFieldElement2.multiply(paramECFieldElement3)); }
  
  public ECFieldElement squareMinusProduct(ECFieldElement paramECFieldElement1, ECFieldElement paramECFieldElement2) { return square().subtract(paramECFieldElement1.multiply(paramECFieldElement2)); }
  
  public ECFieldElement squarePlusProduct(ECFieldElement paramECFieldElement1, ECFieldElement paramECFieldElement2) { return square().add(paramECFieldElement1.multiply(paramECFieldElement2)); }
  
  public ECFieldElement squarePow(int paramInt) {
    ECFieldElement eCFieldElement = this;
    for (byte b = 0; b < paramInt; b++)
      eCFieldElement = eCFieldElement.square(); 
    return eCFieldElement;
  }
  
  public boolean testBitZero() { return toBigInteger().testBit(0); }
  
  public String toString() { return toBigInteger().toString(16); }
  
  public byte[] getEncoded() { return BigIntegers.asUnsignedByteArray((getFieldSize() + 7) / 8, toBigInteger()); }
}
