package org.bouncycastle.pqc.crypto.sphincs;

import org.bouncycastle.crypto.engines.ChaChaEngine;
import org.bouncycastle.crypto.params.KeyParameter;
import org.bouncycastle.crypto.params.ParametersWithIV;
import org.bouncycastle.util.Pack;

class Seed {
  static void get_seed(HashFunctions paramHashFunctions, byte[] paramArrayOfByte1, int paramInt, byte[] paramArrayOfByte2, Tree.leafaddr paramleafaddr) {
    byte[] arrayOfByte = new byte[40];
    for (byte b = 0; b < 32; b++)
      arrayOfByte[b] = paramArrayOfByte2[b]; 
    long l = paramleafaddr.level;
    l |= paramleafaddr.subtree << 4;
    l |= paramleafaddr.subleaf << 59;
    Pack.longToLittleEndian(l, arrayOfByte, 32);
    paramHashFunctions.varlen_hash(paramArrayOfByte1, paramInt, arrayOfByte, arrayOfByte.length);
  }
  
  static void prg(byte[] paramArrayOfByte1, int paramInt1, long paramLong, byte[] paramArrayOfByte2, int paramInt2) {
    byte[] arrayOfByte = new byte[8];
    ChaChaEngine chaChaEngine = new ChaChaEngine(12);
    chaChaEngine.init(true, new ParametersWithIV(new KeyParameter(paramArrayOfByte2, paramInt2, 32), arrayOfByte));
    chaChaEngine.processBytes(paramArrayOfByte1, paramInt1, (int)paramLong, paramArrayOfByte1, paramInt1);
  }
}
