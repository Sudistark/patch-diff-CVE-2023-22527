package org.bouncycastle.crypto.engines;

public class VMPCKSA3Engine extends VMPCEngine {
  public String getAlgorithmName() { return "VMPC-KSA3"; }
  
  protected void initKey(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    this.s = 0;
    this.P = new byte[256];
    int i;
    for (i = 0; i < 256; i++)
      this.P[i] = (byte)i; 
    for (i = 0; i < 768; i++) {
      this.s = this.P[this.s + this.P[i & 0xFF] + paramArrayOfByte1[i % paramArrayOfByte1.length] & 0xFF];
      byte b = this.P[i & 0xFF];
      this.P[i & 0xFF] = this.P[this.s & 0xFF];
      this.P[this.s & 0xFF] = b;
    } 
    for (i = 0; i < 768; i++) {
      this.s = this.P[this.s + this.P[i & 0xFF] + paramArrayOfByte2[i % paramArrayOfByte2.length] & 0xFF];
      byte b = this.P[i & 0xFF];
      this.P[i & 0xFF] = this.P[this.s & 0xFF];
      this.P[this.s & 0xFF] = b;
    } 
    for (i = 0; i < 768; i++) {
      this.s = this.P[this.s + this.P[i & 0xFF] + paramArrayOfByte1[i % paramArrayOfByte1.length] & 0xFF];
      byte b = this.P[i & 0xFF];
      this.P[i & 0xFF] = this.P[this.s & 0xFF];
      this.P[this.s & 0xFF] = b;
    } 
    this.n = 0;
  }
}
