package org.bouncycastle.crypto.generators;

import java.math.BigInteger;
import java.security.SecureRandom;
import org.bouncycastle.math.ec.WNafUtil;
import org.bouncycastle.util.BigIntegers;

class DHParametersHelper {
  private static final BigInteger ONE;
  
  private static final BigInteger TWO = (ONE = BigInteger.valueOf(1L)).valueOf(2L);
  
  static BigInteger[] generateSafePrimes(int paramInt1, int paramInt2, SecureRandom paramSecureRandom) {
    BigInteger bigInteger2;
    BigInteger bigInteger1;
    int i = paramInt1 - 1;
    int j = paramInt1 >>> 2;
    while (true) {
      bigInteger2 = BigIntegers.createRandomPrime(i, 2, paramSecureRandom);
      bigInteger1 = bigInteger2.shiftLeft(1).add(ONE);
      if (!bigInteger1.isProbablePrime(paramInt2) || (paramInt2 > 2 && !bigInteger2.isProbablePrime(paramInt2 - 2)) || WNafUtil.getNafWeight(bigInteger1) < j)
        continue; 
      break;
    } 
    return new BigInteger[] { bigInteger1, bigInteger2 };
  }
  
  static BigInteger selectGenerator(BigInteger paramBigInteger1, BigInteger paramBigInteger2, SecureRandom paramSecureRandom) {
    BigInteger bigInteger2;
    BigInteger bigInteger1 = paramBigInteger1.subtract(TWO);
    do {
      BigInteger bigInteger = BigIntegers.createRandomInRange(TWO, bigInteger1, paramSecureRandom);
      bigInteger2 = bigInteger.modPow(TWO, paramBigInteger1);
    } while (bigInteger2.equals(ONE));
    return bigInteger2;
  }
}
