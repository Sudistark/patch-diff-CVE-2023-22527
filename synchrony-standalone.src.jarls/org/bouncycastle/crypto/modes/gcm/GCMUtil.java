package org.bouncycastle.crypto.modes.gcm;

import org.bouncycastle.math.raw.Interleave;
import org.bouncycastle.util.Longs;
import org.bouncycastle.util.Pack;

public abstract class GCMUtil {
  public static final int SIZE_BYTES = 16;
  
  public static final int SIZE_INTS = 4;
  
  public static final int SIZE_LONGS = 2;
  
  private static final int E1 = -520093696;
  
  private static final long E1L = -2233785415175766016L;
  
  public static byte[] oneAsBytes() {
    byte[] arrayOfByte = new byte[16];
    arrayOfByte[0] = Byte.MIN_VALUE;
    return arrayOfByte;
  }
  
  public static int[] oneAsInts() {
    int[] arrayOfInt = new int[4];
    arrayOfInt[0] = Integer.MIN_VALUE;
    return arrayOfInt;
  }
  
  public static long[] oneAsLongs() {
    long[] arrayOfLong = new long[2];
    arrayOfLong[0] = Float.MIN_VALUE;
    return arrayOfLong;
  }
  
  public static byte areEqual(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    byte b = 0;
    for (byte b1 = 0; b1 < 16; b1++)
      b |= paramArrayOfByte1[b1] ^ paramArrayOfByte2[b1]; 
    b = b >>> 1 | b & true;
    return (byte)(b - 1 >> 31);
  }
  
  public static int areEqual(int[] paramArrayOfInt1, int[] paramArrayOfInt2) {
    int i = 0;
    i |= paramArrayOfInt1[0] ^ paramArrayOfInt2[0];
    i |= paramArrayOfInt1[1] ^ paramArrayOfInt2[1];
    i |= paramArrayOfInt1[2] ^ paramArrayOfInt2[2];
    i |= paramArrayOfInt1[3] ^ paramArrayOfInt2[3];
    i = i >>> 1 | i & true;
    return i - 1 >> 31;
  }
  
  public static long areEqual(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    long l = 0L;
    l |= paramArrayOfLong1[0] ^ paramArrayOfLong2[0];
    l |= paramArrayOfLong1[1] ^ paramArrayOfLong2[1];
    l = l >>> true | l & 0x1L;
    return l - 1L >> 63;
  }
  
  public static byte[] asBytes(int[] paramArrayOfInt) {
    byte[] arrayOfByte = new byte[16];
    Pack.intToBigEndian(paramArrayOfInt, 0, 4, arrayOfByte, 0);
    return arrayOfByte;
  }
  
  public static void asBytes(int[] paramArrayOfInt, byte[] paramArrayOfByte) { Pack.intToBigEndian(paramArrayOfInt, 0, 4, paramArrayOfByte, 0); }
  
  public static byte[] asBytes(long[] paramArrayOfLong) {
    byte[] arrayOfByte = new byte[16];
    Pack.longToBigEndian(paramArrayOfLong, 0, 2, arrayOfByte, 0);
    return arrayOfByte;
  }
  
  public static void asBytes(long[] paramArrayOfLong, byte[] paramArrayOfByte) { Pack.longToBigEndian(paramArrayOfLong, 0, 2, paramArrayOfByte, 0); }
  
  public static int[] asInts(byte[] paramArrayOfByte) {
    int[] arrayOfInt = new int[4];
    Pack.bigEndianToInt(paramArrayOfByte, 0, arrayOfInt, 0, 4);
    return arrayOfInt;
  }
  
  public static void asInts(byte[] paramArrayOfByte, int[] paramArrayOfInt) { Pack.bigEndianToInt(paramArrayOfByte, 0, paramArrayOfInt, 0, 4); }
  
  public static long[] asLongs(byte[] paramArrayOfByte) {
    long[] arrayOfLong = new long[2];
    Pack.bigEndianToLong(paramArrayOfByte, 0, arrayOfLong, 0, 2);
    return arrayOfLong;
  }
  
  public static void asLongs(byte[] paramArrayOfByte, long[] paramArrayOfLong) { Pack.bigEndianToLong(paramArrayOfByte, 0, paramArrayOfLong, 0, 2); }
  
  public static void copy(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    for (byte b = 0; b < 16; b++)
      paramArrayOfByte2[b] = paramArrayOfByte1[b]; 
  }
  
  public static void copy(int[] paramArrayOfInt1, int[] paramArrayOfInt2) {
    paramArrayOfInt2[0] = paramArrayOfInt1[0];
    paramArrayOfInt2[1] = paramArrayOfInt1[1];
    paramArrayOfInt2[2] = paramArrayOfInt1[2];
    paramArrayOfInt2[3] = paramArrayOfInt1[3];
  }
  
  public static void copy(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    paramArrayOfLong2[0] = paramArrayOfLong1[0];
    paramArrayOfLong2[1] = paramArrayOfLong1[1];
  }
  
  public static void divideP(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    long l1 = paramArrayOfLong1[0];
    long l2 = paramArrayOfLong1[1];
    long l3 = l1 >> 63;
    l1 ^= l3 & 0xE100000000000000L;
    paramArrayOfLong2[0] = l1 << true | l2 >>> 63;
    paramArrayOfLong2[1] = l2 << true | -l3;
  }
  
  public static void multiply(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    long[] arrayOfLong1 = asLongs(paramArrayOfByte1);
    long[] arrayOfLong2 = asLongs(paramArrayOfByte2);
    multiply(arrayOfLong1, arrayOfLong2);
    asBytes(arrayOfLong1, paramArrayOfByte1);
  }
  
  public static void multiply(int[] paramArrayOfInt1, int[] paramArrayOfInt2) {
    int i = paramArrayOfInt2[0];
    int j = paramArrayOfInt2[1];
    int k = paramArrayOfInt2[2];
    int m = paramArrayOfInt2[3];
    int n = 0;
    int i1 = 0;
    int i2 = 0;
    int i3 = 0;
    for (byte b = 0; b < 4; b++) {
      int i4 = paramArrayOfInt1[b];
      for (byte b1 = 0; b1 < 32; b1++) {
        int i5 = i4 >> 31;
        i4 <<= 1;
        n ^= i & i5;
        i1 ^= j & i5;
        i2 ^= k & i5;
        i3 ^= m & i5;
        int i6 = m << 31 >> 8;
        m = m >>> 1 | k << 31;
        k = k >>> 1 | j << 31;
        j = j >>> 1 | i << 31;
        i = i >>> 1 ^ i6 & 0xE1000000;
      } 
    } 
    paramArrayOfInt1[0] = n;
    paramArrayOfInt1[1] = i1;
    paramArrayOfInt1[2] = i2;
    paramArrayOfInt1[3] = i3;
  }
  
  public static void multiply(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    long l1 = paramArrayOfLong1[0];
    long l2 = paramArrayOfLong1[1];
    long l3 = paramArrayOfLong2[0];
    long l4 = paramArrayOfLong2[1];
    long l5 = Longs.reverse(l1);
    long l6 = Longs.reverse(l2);
    long l7 = Longs.reverse(l3);
    long l8 = Longs.reverse(l4);
    long l9 = Longs.reverse(implMul64(l5, l7));
    long l10 = implMul64(l1, l3) << true;
    long l11 = Longs.reverse(implMul64(l6, l8));
    long l12 = implMul64(l2, l4) << true;
    long l13 = Longs.reverse(implMul64(l5 ^ l6, l7 ^ l8));
    long l14 = implMul64(l1 ^ l2, l3 ^ l4) << true;
    long l15 = l9;
    long l16 = l10 ^ l9 ^ l11 ^ l13;
    long l17 = l11 ^ l10 ^ l12 ^ l14;
    long l18 = l12;
    l16 ^= l18 ^ l18 >>> true ^ l18 >>> 2 ^ l18 >>> 7;
    l17 ^= l18 << 62 ^ l18 << 57;
    l15 ^= l17 ^ l17 >>> true ^ l17 >>> 2 ^ l17 >>> 7;
    l16 ^= l17 << 63 ^ l17 << 62 ^ l17 << 57;
    paramArrayOfLong1[0] = l15;
    paramArrayOfLong1[1] = l16;
  }
  
  public static void multiplyP(int[] paramArrayOfInt) {
    int i = paramArrayOfInt[0];
    int j = paramArrayOfInt[1];
    int k = paramArrayOfInt[2];
    int m = paramArrayOfInt[3];
    int n = m << 31 >> 31;
    paramArrayOfInt[0] = i >>> 1 ^ n & 0xE1000000;
    paramArrayOfInt[1] = j >>> 1 | i << 31;
    paramArrayOfInt[2] = k >>> 1 | j << 31;
    paramArrayOfInt[3] = m >>> 1 | k << 31;
  }
  
  public static void multiplyP(int[] paramArrayOfInt1, int[] paramArrayOfInt2) {
    int i = paramArrayOfInt1[0];
    int j = paramArrayOfInt1[1];
    int k = paramArrayOfInt1[2];
    int m = paramArrayOfInt1[3];
    int n = m << 31 >> 31;
    paramArrayOfInt2[0] = i >>> 1 ^ n & 0xE1000000;
    paramArrayOfInt2[1] = j >>> 1 | i << 31;
    paramArrayOfInt2[2] = k >>> 1 | j << 31;
    paramArrayOfInt2[3] = m >>> 1 | k << 31;
  }
  
  public static void multiplyP(long[] paramArrayOfLong) {
    long l1 = paramArrayOfLong[0];
    long l2 = paramArrayOfLong[1];
    long l3 = l2 << 63 >> 63;
    paramArrayOfLong[0] = l1 >>> true ^ l3 & 0xE100000000000000L;
    paramArrayOfLong[1] = l2 >>> true | l1 << 63;
  }
  
  public static void multiplyP(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    long l1 = paramArrayOfLong1[0];
    long l2 = paramArrayOfLong1[1];
    long l3 = l2 << 63 >> 63;
    paramArrayOfLong2[0] = l1 >>> true ^ l3 & 0xE100000000000000L;
    paramArrayOfLong2[1] = l2 >>> true | l1 << 63;
  }
  
  public static void multiplyP3(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    long l1 = paramArrayOfLong1[0];
    long l2 = paramArrayOfLong1[1];
    long l3 = l2 << 61;
    paramArrayOfLong2[0] = l1 >>> 3 ^ l3 ^ l3 >>> true ^ l3 >>> 2 ^ l3 >>> 7;
    paramArrayOfLong2[1] = l2 >>> 3 | l1 << 61;
  }
  
  public static void multiplyP4(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    long l1 = paramArrayOfLong1[0];
    long l2 = paramArrayOfLong1[1];
    long l3 = l2 << 60;
    paramArrayOfLong2[0] = l1 >>> 4 ^ l3 ^ l3 >>> true ^ l3 >>> 2 ^ l3 >>> 7;
    paramArrayOfLong2[1] = l2 >>> 4 | l1 << 60;
  }
  
  public static void multiplyP7(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    long l1 = paramArrayOfLong1[0];
    long l2 = paramArrayOfLong1[1];
    long l3 = l2 << 57;
    paramArrayOfLong2[0] = l1 >>> 7 ^ l3 ^ l3 >>> true ^ l3 >>> 2 ^ l3 >>> 7;
    paramArrayOfLong2[1] = l2 >>> 7 | l1 << 57;
  }
  
  public static void multiplyP8(int[] paramArrayOfInt) {
    int i = paramArrayOfInt[0];
    int j = paramArrayOfInt[1];
    int k = paramArrayOfInt[2];
    int m = paramArrayOfInt[3];
    int n = m << 24;
    paramArrayOfInt[0] = i >>> 8 ^ n ^ n >>> 1 ^ n >>> 2 ^ n >>> 7;
    paramArrayOfInt[1] = j >>> 8 | i << 24;
    paramArrayOfInt[2] = k >>> 8 | j << 24;
    paramArrayOfInt[3] = m >>> 8 | k << 24;
  }
  
  public static void multiplyP8(int[] paramArrayOfInt1, int[] paramArrayOfInt2) {
    int i = paramArrayOfInt1[0];
    int j = paramArrayOfInt1[1];
    int k = paramArrayOfInt1[2];
    int m = paramArrayOfInt1[3];
    int n = m << 24;
    paramArrayOfInt2[0] = i >>> 8 ^ n ^ n >>> 1 ^ n >>> 2 ^ n >>> 7;
    paramArrayOfInt2[1] = j >>> 8 | i << 24;
    paramArrayOfInt2[2] = k >>> 8 | j << 24;
    paramArrayOfInt2[3] = m >>> 8 | k << 24;
  }
  
  public static void multiplyP8(long[] paramArrayOfLong) {
    long l1 = paramArrayOfLong[0];
    long l2 = paramArrayOfLong[1];
    long l3 = l2 << 56;
    paramArrayOfLong[0] = l1 >>> 8 ^ l3 ^ l3 >>> true ^ l3 >>> 2 ^ l3 >>> 7;
    paramArrayOfLong[1] = l2 >>> 8 | l1 << 56;
  }
  
  public static void multiplyP8(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    long l1 = paramArrayOfLong1[0];
    long l2 = paramArrayOfLong1[1];
    long l3 = l2 << 56;
    paramArrayOfLong2[0] = l1 >>> 8 ^ l3 ^ l3 >>> true ^ l3 >>> 2 ^ l3 >>> 7;
    paramArrayOfLong2[1] = l2 >>> 8 | l1 << 56;
  }
  
  public static long[] pAsLongs() {
    long[] arrayOfLong = new long[2];
    arrayOfLong[0] = 4611686018427387904L;
    return arrayOfLong;
  }
  
  public static void square(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    long[] arrayOfLong = new long[4];
    Interleave.expand64To128Rev(paramArrayOfLong1[0], arrayOfLong, 0);
    Interleave.expand64To128Rev(paramArrayOfLong1[1], arrayOfLong, 2);
    long l1 = arrayOfLong[0];
    long l2 = arrayOfLong[1];
    long l3 = arrayOfLong[2];
    long l4 = arrayOfLong[3];
    l2 ^= l4 ^ l4 >>> true ^ l4 >>> 2 ^ l4 >>> 7;
    l3 ^= l4 << 63 ^ l4 << 62 ^ l4 << 57;
    l1 ^= l3 ^ l3 >>> true ^ l3 >>> 2 ^ l3 >>> 7;
    l2 ^= l3 << 63 ^ l3 << 62 ^ l3 << 57;
    paramArrayOfLong2[0] = l1;
    paramArrayOfLong2[1] = l2;
  }
  
  public static void xor(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) {
    byte b = 0;
    do {
      paramArrayOfByte1[b] = (byte)(paramArrayOfByte1[b] ^ paramArrayOfByte2[b]);
      paramArrayOfByte1[++b] = (byte)(paramArrayOfByte1[++b] ^ paramArrayOfByte2[b]);
      paramArrayOfByte1[++b] = (byte)(paramArrayOfByte1[++b] ^ paramArrayOfByte2[b]);
      paramArrayOfByte1[++b] = (byte)(paramArrayOfByte1[++b] ^ paramArrayOfByte2[b]);
    } while (++b < 16);
  }
  
  public static void xor(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2, int paramInt) {
    int i = 0;
    do {
      paramArrayOfByte1[i] = (byte)(paramArrayOfByte1[i] ^ paramArrayOfByte2[paramInt + i]);
      paramArrayOfByte1[++i] = (byte)(paramArrayOfByte1[++i] ^ paramArrayOfByte2[paramInt + i]);
      paramArrayOfByte1[++i] = (byte)(paramArrayOfByte1[++i] ^ paramArrayOfByte2[paramInt + i]);
      paramArrayOfByte1[++i] = (byte)(paramArrayOfByte1[++i] ^ paramArrayOfByte2[paramInt + i]);
    } while (++i < 16);
  }
  
  public static void xor(byte[] paramArrayOfByte1, int paramInt1, byte[] paramArrayOfByte2, int paramInt2, byte[] paramArrayOfByte3, int paramInt3) {
    int i = 0;
    do {
      paramArrayOfByte3[paramInt3 + i] = (byte)(paramArrayOfByte1[paramInt1 + i] ^ paramArrayOfByte2[paramInt2 + i]);
      paramArrayOfByte3[paramInt3 + ++i] = (byte)(paramArrayOfByte1[paramInt1 + i] ^ paramArrayOfByte2[paramInt2 + i]);
      paramArrayOfByte3[paramInt3 + ++i] = (byte)(paramArrayOfByte1[paramInt1 + i] ^ paramArrayOfByte2[paramInt2 + i]);
      paramArrayOfByte3[paramInt3 + ++i] = (byte)(paramArrayOfByte1[paramInt1 + i] ^ paramArrayOfByte2[paramInt2 + i]);
    } while (++i < 16);
  }
  
  public static void xor(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2, int paramInt1, int paramInt2) {
    while (--paramInt2 >= 0)
      paramArrayOfByte1[paramInt2] = (byte)(paramArrayOfByte1[paramInt2] ^ paramArrayOfByte2[paramInt1 + paramInt2]); 
  }
  
  public static void xor(byte[] paramArrayOfByte1, int paramInt1, byte[] paramArrayOfByte2, int paramInt2, int paramInt3) {
    while (--paramInt3 >= 0)
      paramArrayOfByte1[paramInt1 + paramInt3] = (byte)(paramArrayOfByte1[paramInt1 + paramInt3] ^ paramArrayOfByte2[paramInt2 + paramInt3]); 
  }
  
  public static void xor(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2, byte[] paramArrayOfByte3) {
    byte b = 0;
    do {
      paramArrayOfByte3[b] = (byte)(paramArrayOfByte1[b] ^ paramArrayOfByte2[b]);
      paramArrayOfByte3[++b] = (byte)(paramArrayOfByte1[b] ^ paramArrayOfByte2[b]);
      paramArrayOfByte3[++b] = (byte)(paramArrayOfByte1[b] ^ paramArrayOfByte2[b]);
      paramArrayOfByte3[++b] = (byte)(paramArrayOfByte1[b] ^ paramArrayOfByte2[b]);
    } while (++b < 16);
  }
  
  public static void xor(int[] paramArrayOfInt1, int[] paramArrayOfInt2) {
    paramArrayOfInt1[0] = paramArrayOfInt1[0] ^ paramArrayOfInt2[0];
    paramArrayOfInt1[1] = paramArrayOfInt1[1] ^ paramArrayOfInt2[1];
    paramArrayOfInt1[2] = paramArrayOfInt1[2] ^ paramArrayOfInt2[2];
    paramArrayOfInt1[3] = paramArrayOfInt1[3] ^ paramArrayOfInt2[3];
  }
  
  public static void xor(int[] paramArrayOfInt1, int[] paramArrayOfInt2, int[] paramArrayOfInt3) {
    paramArrayOfInt3[0] = paramArrayOfInt1[0] ^ paramArrayOfInt2[0];
    paramArrayOfInt3[1] = paramArrayOfInt1[1] ^ paramArrayOfInt2[1];
    paramArrayOfInt3[2] = paramArrayOfInt1[2] ^ paramArrayOfInt2[2];
    paramArrayOfInt3[3] = paramArrayOfInt1[3] ^ paramArrayOfInt2[3];
  }
  
  public static void xor(long[] paramArrayOfLong1, long[] paramArrayOfLong2) {
    paramArrayOfLong1[0] = paramArrayOfLong1[0] ^ paramArrayOfLong2[0];
    paramArrayOfLong1[1] = paramArrayOfLong1[1] ^ paramArrayOfLong2[1];
  }
  
  public static void xor(long[] paramArrayOfLong1, long[] paramArrayOfLong2, long[] paramArrayOfLong3) {
    paramArrayOfLong3[0] = paramArrayOfLong1[0] ^ paramArrayOfLong2[0];
    paramArrayOfLong3[1] = paramArrayOfLong1[1] ^ paramArrayOfLong2[1];
  }
  
  private static long implMul64(long paramLong1, long paramLong2) {
    long l1 = paramLong1 & 0x1111111111111111L;
    long l2 = paramLong1 & 0x2222222222222222L;
    long l3 = paramLong1 & 0x4444444444444444L;
    long l4 = paramLong1 & 0x8888888888888888L;
    long l5 = paramLong2 & 0x1111111111111111L;
    long l6 = paramLong2 & 0x2222222222222222L;
    long l7 = paramLong2 & 0x4444444444444444L;
    long l8 = paramLong2 & 0x8888888888888888L;
    long l9 = l1 * l5 ^ l2 * l8 ^ l3 * l7 ^ l4 * l6;
    long l10 = l1 * l6 ^ l2 * l5 ^ l3 * l8 ^ l4 * l7;
    long l11 = l1 * l7 ^ l2 * l6 ^ l3 * l5 ^ l4 * l8;
    long l12 = l1 * l8 ^ l2 * l7 ^ l3 * l6 ^ l4 * l5;
    l9 &= 0x1111111111111111L;
    l10 &= 0x2222222222222222L;
    l11 &= 0x4444444444444444L;
    l12 &= 0x8888888888888888L;
    return l9 | l10 | l11 | l12;
  }
}
