package com.hazelcast.multimap.impl.operations;

import com.hazelcast.multimap.impl.MultiMapContainer;
import com.hazelcast.multimap.impl.MultiMapService;
import com.hazelcast.spi.ReadonlyOperation;

public class ValuesOperation extends AbstractMultiMapOperation implements ReadonlyOperation {
  public ValuesOperation() {}
  
  public ValuesOperation(String name) { super(name); }
  
  public void run() {
    MultiMapContainer container = getOrCreateContainer();
    ((MultiMapService)getService()).getLocalMultiMapStatsImpl(this.name).incrementOtherOperations();
    this.response = new MultiMapResponse(container.values(), getValueCollectionType(container));
  }
  
  public int getId() { return 26; }
}
