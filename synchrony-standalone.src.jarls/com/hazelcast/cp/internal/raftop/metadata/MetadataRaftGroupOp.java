package com.hazelcast.cp.internal.raftop.metadata;

import com.hazelcast.cp.CPGroupId;
import com.hazelcast.cp.internal.MetadataRaftGroupManager;
import com.hazelcast.cp.internal.RaftOp;
import com.hazelcast.cp.internal.RaftService;
import com.hazelcast.util.Preconditions;

public abstract class MetadataRaftGroupOp extends RaftOp {
  public final Object run(CPGroupId groupId, long commitIndex) throws Exception {
    RaftService service = (RaftService)getService();
    MetadataRaftGroupManager metadataGroupManager = service.getMetadataGroupManager();
    Preconditions.checkTrue(metadataGroupManager.getMetadataGroupId().equals(groupId), "Cannot perform CP subsystem management call on " + groupId);
    return run(metadataGroupManager, commitIndex);
  }
  
  public abstract Object run(MetadataRaftGroupManager paramMetadataRaftGroupManager, long paramLong) throws Exception;
  
  public final String getServiceName() { return "hz:core:raft"; }
}
