package com.hazelcast.collection.impl.queue.operations;

import com.hazelcast.collection.impl.queue.QueueContainer;
import com.hazelcast.collection.impl.queue.QueueDataSerializerHook;
import com.hazelcast.collection.impl.queue.QueueItem;
import com.hazelcast.monitor.impl.LocalQueueStatsImpl;
import com.hazelcast.nio.serialization.IdentifiedDataSerializable;
import com.hazelcast.spi.ReadonlyOperation;

public final class PeekOperation extends QueueOperation implements IdentifiedDataSerializable, ReadonlyOperation {
  public PeekOperation() {}
  
  public PeekOperation(String name) { super(name); }
  
  public void run() {
    QueueContainer queueContainer = getContainer();
    QueueItem item = queueContainer.peek();
    this.response = (item != null) ? item.getData() : null;
  }
  
  public void afterRun() {
    LocalQueueStatsImpl stats = getQueueService().getLocalQueueStatsImpl(this.name);
    stats.incrementOtherOperations();
  }
  
  public int getFactoryId() { return QueueDataSerializerHook.F_ID; }
  
  public int getId() { return 2; }
}
