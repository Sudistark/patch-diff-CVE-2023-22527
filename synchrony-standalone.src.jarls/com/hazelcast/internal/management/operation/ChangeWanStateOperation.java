package com.hazelcast.internal.management.operation;

import com.hazelcast.config.WanPublisherState;
import com.hazelcast.spi.AbstractLocalOperation;
import com.hazelcast.spi.NodeEngine;
import com.hazelcast.wan.WanReplicationService;

public class ChangeWanStateOperation extends AbstractLocalOperation {
  private String schemeName;
  
  private String publisherName;
  
  private WanPublisherState state;
  
  public ChangeWanStateOperation(String schemeName, String publisherName, WanPublisherState state) {
    this.schemeName = schemeName;
    this.publisherName = publisherName;
    this.state = state;
  }
  
  public void run() throws Exception {
    NodeEngine nodeEngine = getNodeEngine();
    WanReplicationService wanReplicationService = nodeEngine.getWanReplicationService();
    switch (null.$SwitchMap$com$hazelcast$config$WanPublisherState[this.state.ordinal()]) {
      case 1:
        wanReplicationService.resume(this.schemeName, this.publisherName);
        break;
      case 2:
        wanReplicationService.pause(this.schemeName, this.publisherName);
        break;
      case 3:
        wanReplicationService.stop(this.schemeName, this.publisherName);
        break;
    } 
  }
}
