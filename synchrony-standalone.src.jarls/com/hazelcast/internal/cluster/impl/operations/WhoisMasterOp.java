package com.hazelcast.internal.cluster.impl.operations;

import com.hazelcast.internal.cluster.impl.ClusterServiceImpl;
import com.hazelcast.internal.cluster.impl.JoinMessage;
import com.hazelcast.nio.ObjectDataInput;
import com.hazelcast.nio.ObjectDataOutput;
import java.io.IOException;

public class WhoisMasterOp extends AbstractClusterOperation {
  private JoinMessage joinMessage;
  
  public WhoisMasterOp() {}
  
  public WhoisMasterOp(JoinMessage joinMessage) { this.joinMessage = joinMessage; }
  
  public void run() {
    ClusterServiceImpl cm = (ClusterServiceImpl)getService();
    cm.getClusterJoinManager().answerWhoisMasterQuestion(this.joinMessage, getConnection());
  }
  
  protected void readInternal(ObjectDataInput in) throws IOException {
    this.joinMessage = new JoinMessage();
    this.joinMessage.readData(in);
  }
  
  protected void writeInternal(ObjectDataOutput out) throws IOException { this.joinMessage.writeData(out); }
  
  protected void toString(StringBuilder sb) {
    super.toString(sb);
    sb.append(", message=").append(this.joinMessage);
  }
  
  public int getId() { return 18; }
}
