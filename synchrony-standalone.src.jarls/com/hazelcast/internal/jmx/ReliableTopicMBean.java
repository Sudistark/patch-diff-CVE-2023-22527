package com.hazelcast.internal.jmx;

import com.hazelcast.config.Config;
import com.hazelcast.config.ReliableTopicConfig;
import com.hazelcast.topic.impl.reliable.ReliableTopicProxy;

@ManagedDescription("ReliableTopic")
public class ReliableTopicMBean extends HazelcastMBean<ReliableTopicProxy> {
  protected ReliableTopicMBean(ReliableTopicProxy managedObject, ManagementService service) {
    super(managedObject, service);
    this.objectName = service.createObjectName("ReliableTopic", managedObject.getName());
  }
  
  @ManagedAnnotation("localCreationTime")
  @ManagedDescription("the creation time of this reliable topic on this member")
  public long getLocalCreationTime() { return ((ReliableTopicProxy)this.managedObject).getLocalTopicStats().getCreationTime(); }
  
  @ManagedAnnotation("localPublishOperationCount")
  @ManagedDescription(" the total number of published messages of this reliable topic on this member")
  public long getLocalPublishOperationCount() { return ((ReliableTopicProxy)this.managedObject).getLocalTopicStats().getPublishOperationCount(); }
  
  @ManagedAnnotation("localReceiveOperationCount")
  @ManagedDescription("the total number of received messages of this reliable topic on this member")
  public long getLocalReceiveOperationCount() { return ((ReliableTopicProxy)this.managedObject).getLocalTopicStats().getReceiveOperationCount(); }
  
  @ManagedAnnotation("name")
  @ManagedDescription("Name of the DistributedObject")
  public String getName() { return ((ReliableTopicProxy)this.managedObject).getName(); }
  
  @ManagedAnnotation("config")
  public String getConfig() {
    Config config = this.service.instance.getConfig();
    ReliableTopicConfig topicConfig = config.findReliableTopicConfig(((ReliableTopicProxy)this.managedObject).getName());
    return topicConfig.toString();
  }
}
