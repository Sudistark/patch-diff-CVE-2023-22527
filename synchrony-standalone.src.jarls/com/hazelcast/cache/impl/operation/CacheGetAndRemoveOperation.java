package com.hazelcast.cache.impl.operation;

import com.hazelcast.nio.serialization.Data;
import com.hazelcast.spi.Operation;

public class CacheGetAndRemoveOperation extends MutatingCacheOperation {
  public CacheGetAndRemoveOperation() {}
  
  public CacheGetAndRemoveOperation(String name, Data key, int completionId) { super(name, key, completionId); }
  
  public void run() { this.response = this.recordStore.getAndRemove(this.key, getCallerUuid(), this.completionId); }
  
  public void afterRun() {
    if (this.response != null)
      publishWanRemove(this.key); 
    super.afterRun();
  }
  
  public boolean shouldBackup() { return (this.response != null); }
  
  public Operation getBackupOperation() { return new CacheRemoveBackupOperation(this.name, this.key); }
  
  public int getId() { return 6; }
}
