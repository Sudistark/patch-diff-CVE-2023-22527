package com.hazelcast.cache.impl.operation;

import com.hazelcast.cache.impl.ICacheRecordStore;
import com.hazelcast.cache.impl.ICacheService;
import com.hazelcast.spi.ReadonlyOperation;

public class CacheSizeOperation extends PartitionWideCacheOperation implements ReadonlyOperation {
  public CacheSizeOperation() {}
  
  public CacheSizeOperation(String name) { super(name); }
  
  public void run() {
    ICacheService service = (ICacheService)getService();
    ICacheRecordStore cache = service.getRecordStore(this.name, getPartitionId());
    this.response = Integer.valueOf((cache != null) ? cache.size() : 0);
  }
  
  public int getId() { return 13; }
}
