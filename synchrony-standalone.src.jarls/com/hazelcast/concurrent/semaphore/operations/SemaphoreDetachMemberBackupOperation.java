package com.hazelcast.concurrent.semaphore.operations;

import com.hazelcast.concurrent.semaphore.SemaphoreContainer;
import com.hazelcast.concurrent.semaphore.SemaphoreService;

public class SemaphoreDetachMemberBackupOperation extends SemaphoreBackupOperation {
  public SemaphoreDetachMemberBackupOperation() {}
  
  public SemaphoreDetachMemberBackupOperation(String name, String firstCaller) { super(name, -1, firstCaller); }
  
  public void run() {
    SemaphoreService service = (SemaphoreService)getService();
    if (service.containsSemaphore(this.name)) {
      SemaphoreContainer semaphoreContainer = service.getSemaphoreContainer(this.name);
      this.response = Boolean.valueOf(semaphoreContainer.detachAll(this.firstCaller));
    } 
  }
  
  public int getId() { return 4; }
}
