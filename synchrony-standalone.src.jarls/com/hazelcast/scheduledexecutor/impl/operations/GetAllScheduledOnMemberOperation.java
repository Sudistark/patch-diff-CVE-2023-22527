package com.hazelcast.scheduledexecutor.impl.operations;

import com.hazelcast.scheduledexecutor.ScheduledTaskHandler;
import com.hazelcast.scheduledexecutor.impl.DistributedScheduledExecutorService;
import com.hazelcast.spi.ReadonlyOperation;
import java.util.ArrayList;
import java.util.List;

public class GetAllScheduledOnMemberOperation extends AbstractGetAllScheduledOperation implements ReadonlyOperation {
  private static final int MEMBER_BIN = -1;
  
  private List<ScheduledTaskHandler> response;
  
  public GetAllScheduledOnMemberOperation() {}
  
  public GetAllScheduledOnMemberOperation(String schedulerName) { super(schedulerName); }
  
  public void run() {
    List<ScheduledTaskHandler> handlers = new ArrayList<ScheduledTaskHandler>();
    DistributedScheduledExecutorService service = (DistributedScheduledExecutorService)getService();
    populateScheduledForHolder(handlers, service, -1);
    this.response = handlers;
  }
  
  public List<ScheduledTaskHandler> getResponse() { return this.response; }
  
  public int getId() { return 22; }
}
