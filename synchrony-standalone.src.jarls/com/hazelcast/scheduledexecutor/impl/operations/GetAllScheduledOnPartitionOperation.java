package com.hazelcast.scheduledexecutor.impl.operations;

import com.hazelcast.scheduledexecutor.ScheduledTaskHandler;
import com.hazelcast.scheduledexecutor.impl.DistributedScheduledExecutorService;
import com.hazelcast.spi.ReadonlyOperation;
import java.util.ArrayList;
import java.util.List;

public class GetAllScheduledOnPartitionOperation extends AbstractGetAllScheduledOperation implements ReadonlyOperation {
  private List<ScheduledTaskHandler> response;
  
  public GetAllScheduledOnPartitionOperation() {}
  
  public GetAllScheduledOnPartitionOperation(String schedulerName) { super(schedulerName); }
  
  public void run() {
    List<ScheduledTaskHandler> handlers = new ArrayList<ScheduledTaskHandler>();
    DistributedScheduledExecutorService service = (DistributedScheduledExecutorService)getService();
    populateScheduledForHolder(handlers, service, getPartitionId());
    this.response = handlers;
  }
  
  public List<ScheduledTaskHandler> getResponse() { return this.response; }
  
  public int getId() { return 25; }
}
