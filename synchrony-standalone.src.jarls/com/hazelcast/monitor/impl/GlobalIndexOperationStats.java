package com.hazelcast.monitor.impl;

import com.hazelcast.query.impl.IndexHeapMemoryCostUtil;

public class GlobalIndexOperationStats implements IndexOperationStats {
  private long entryCountDelta;
  
  private long memoryCostDelta;
  
  public long getEntryCountDelta() { return this.entryCountDelta; }
  
  public long getMemoryCostDelta() { return this.memoryCostDelta; }
  
  public void onEntryAdded(Object replacedValue, Object addedValue) {
    this.memoryCostDelta += IndexHeapMemoryCostUtil.estimateValueCost(addedValue);
    if (replacedValue == null) {
      this.entryCountDelta++;
    } else {
      this.memoryCostDelta -= IndexHeapMemoryCostUtil.estimateValueCost(replacedValue);
    } 
  }
  
  public void onEntryRemoved(Object removedValue) {
    if (removedValue != null) {
      this.entryCountDelta--;
      this.memoryCostDelta -= IndexHeapMemoryCostUtil.estimateValueCost(removedValue);
    } 
  }
}
