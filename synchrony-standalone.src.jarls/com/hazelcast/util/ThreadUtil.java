package com.hazelcast.util;

public final class ThreadUtil {
  private static final ThreadLocal<Long> THREAD_LOCAL = new ThreadLocal();
  
  public static long getThreadId() {
    threadId = (Long)THREAD_LOCAL.get();
    if (threadId != null)
      return threadId.longValue(); 
    return Thread.currentThread().getId();
  }
  
  public static void setThreadId(long threadId) { THREAD_LOCAL.set(Long.valueOf(threadId)); }
  
  public static void removeThreadId() { THREAD_LOCAL.remove(); }
  
  public static String createThreadName(String hzName, String name) {
    Preconditions.checkNotNull(name, "name can't be null");
    return "hz." + hzName + "." + name;
  }
  
  public static String createThreadPoolName(String hzName, String poolName) { return createThreadName(hzName, poolName) + ".thread-"; }
  
  public static void assertRunningOnPartitionThread() { assert Thread.currentThread().getName().contains("partition-operation"); }
}
