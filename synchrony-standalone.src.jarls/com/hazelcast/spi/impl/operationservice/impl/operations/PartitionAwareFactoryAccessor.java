package com.hazelcast.spi.impl.operationservice.impl.operations;

import com.hazelcast.client.impl.operations.OperationFactoryWrapper;
import com.hazelcast.spi.OperationFactory;

public final class PartitionAwareFactoryAccessor {
  public static PartitionAwareOperationFactory extractPartitionAware(OperationFactory operationFactory) {
    if (operationFactory instanceof PartitionAwareOperationFactory)
      return (PartitionAwareOperationFactory)operationFactory; 
    if (operationFactory instanceof OperationFactoryWrapper) {
      OperationFactory unwrapped = ((OperationFactoryWrapper)operationFactory).getOperationFactory();
      if (unwrapped instanceof PartitionAwareOperationFactory)
        return (PartitionAwareOperationFactory)unwrapped; 
    } 
    return null;
  }
}
