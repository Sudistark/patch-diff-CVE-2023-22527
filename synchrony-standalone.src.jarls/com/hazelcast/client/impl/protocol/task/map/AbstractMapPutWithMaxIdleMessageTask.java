package com.hazelcast.client.impl.protocol.task.map;

import com.hazelcast.client.impl.protocol.ClientMessage;
import com.hazelcast.instance.Node;
import com.hazelcast.internal.cluster.Versions;
import com.hazelcast.nio.Connection;

public abstract class AbstractMapPutWithMaxIdleMessageTask<P> extends AbstractMapPutMessageTask<P> {
  protected AbstractMapPutWithMaxIdleMessageTask(ClientMessage clientMessage, Node node, Connection connection) { super(clientMessage, node, connection); }
  
  protected void beforeProcess() {
    super.beforeProcess();
    checkCompatibility();
  }
  
  void checkCompatibility() {
    if (this.nodeEngine.getClusterService().getClusterVersion().isLessThan(Versions.V3_11))
      throw new UnsupportedOperationException("Setting MaxIdle is available when cluster version is 3.11 or higher"); 
  }
}
