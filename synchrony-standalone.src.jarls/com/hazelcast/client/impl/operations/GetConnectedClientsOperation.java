package com.hazelcast.client.impl.operations;

import com.hazelcast.client.impl.ClientEndpointImpl;
import com.hazelcast.client.impl.ClientEngine;
import com.hazelcast.core.Client;
import com.hazelcast.core.ClientType;
import com.hazelcast.spi.ReadonlyOperation;
import com.hazelcast.util.MapUtil;
import java.util.Collection;
import java.util.Map;

public class GetConnectedClientsOperation extends AbstractClientOperation implements ReadonlyOperation {
  private Map<String, ClientType> clients;
  
  public void run() {
    ClientEngine service = (ClientEngine)getService();
    Collection<Client> serviceClients = service.getClients();
    this.clients = MapUtil.createHashMap(serviceClients.size());
    for (Client clientEndpoint : serviceClients) {
      ClientEndpointImpl clientEndpointImpl = (ClientEndpointImpl)clientEndpoint;
      this.clients.put(clientEndpointImpl.getUuid(), clientEndpointImpl.getClientType());
    } 
  }
  
  public Object getResponse() { return this.clients; }
  
  public int getId() { return 2; }
}
