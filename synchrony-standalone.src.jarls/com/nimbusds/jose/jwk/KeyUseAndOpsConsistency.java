package com.nimbusds.jose.jwk;

import java.util.Arrays;
import java.util.Collections;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;

class KeyUseAndOpsConsistency {
  static Map<KeyUse, Set<KeyOperation>> MAP;
  
  static  {
    map = new HashMap();
    map.put(KeyUse.SIGNATURE, new HashSet(
          
          Arrays.asList(new KeyOperation[] { KeyOperation.SIGN, KeyOperation.VERIFY })));
    map.put(KeyUse.ENCRYPTION, new HashSet(
          
          Arrays.asList(new KeyOperation[] { KeyOperation.ENCRYPT, KeyOperation.DECRYPT, KeyOperation.WRAP_KEY, KeyOperation.UNWRAP_KEY })));
    MAP = Collections.unmodifiableMap(map);
  }
  
  static boolean areConsistent(KeyUse use, Set<KeyOperation> ops) {
    if (use == null || ops == null)
      return true; 
    return ((Set)MAP.get(use)).containsAll(ops);
  }
}
