package com.fasterxml.jackson.databind.deser;

import com.fasterxml.jackson.databind.BeanDescription;
import com.fasterxml.jackson.databind.DeserializationConfig;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.JavaType;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.cfg.CoercionAction;
import com.fasterxml.jackson.databind.cfg.CoercionInputShape;
import com.fasterxml.jackson.databind.deser.impl.PropertyValueBuffer;
import com.fasterxml.jackson.databind.introspect.AnnotatedWithParams;
import com.fasterxml.jackson.databind.type.LogicalType;
import java.io.IOException;
import java.math.BigDecimal;
import java.math.BigInteger;

public abstract class ValueInstantiator {
  public ValueInstantiator createContextual(DeserializationContext ctxt, BeanDescription beanDesc) throws JsonMappingException { return this; }
  
  public Class<?> getValueClass() { return Object.class; }
  
  public String getValueTypeDesc() {
    Class<?> cls = getValueClass();
    if (cls == null)
      return "UNKNOWN"; 
    return cls.getName();
  }
  
  public boolean canInstantiate() {
    return (canCreateUsingDefault() || 
      canCreateUsingDelegate() || canCreateUsingArrayDelegate() || 
      canCreateFromObjectWith() || canCreateFromString() || 
      canCreateFromInt() || canCreateFromLong() || 
      canCreateFromDouble() || canCreateFromBoolean());
  }
  
  public boolean canCreateFromString() { return false; }
  
  public boolean canCreateFromInt() { return false; }
  
  public boolean canCreateFromLong() { return false; }
  
  public boolean canCreateFromBigInteger() { return false; }
  
  public boolean canCreateFromDouble() { return false; }
  
  public boolean canCreateFromBigDecimal() { return false; }
  
  public boolean canCreateFromBoolean() { return false; }
  
  public boolean canCreateUsingDefault() { return (getDefaultCreator() != null); }
  
  public boolean canCreateUsingDelegate() { return false; }
  
  public boolean canCreateUsingArrayDelegate() { return false; }
  
  public boolean canCreateFromObjectWith() { return false; }
  
  public SettableBeanProperty[] getFromObjectArguments(DeserializationConfig config) { return null; }
  
  public JavaType getDelegateType(DeserializationConfig config) { return null; }
  
  public JavaType getArrayDelegateType(DeserializationConfig config) { return null; }
  
  public Object createUsingDefault(DeserializationContext ctxt) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no default no-arguments constructor found", new Object[0]); }
  
  public Object createFromObjectWith(DeserializationContext ctxt, Object[] args) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no creator with arguments specified", new Object[0]); }
  
  public Object createUsingDefaultOrWithoutArguments(DeserializationContext ctxt) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "neither default (no-arguments) nor with-arguments Creator found", new Object[0]); }
  
  public Object createFromObjectWith(DeserializationContext ctxt, SettableBeanProperty[] props, PropertyValueBuffer buffer) throws IOException { return createFromObjectWith(ctxt, buffer.getParameters(props)); }
  
  public Object createUsingDelegate(DeserializationContext ctxt, Object delegate) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no delegate creator specified", new Object[0]); }
  
  public Object createUsingArrayDelegate(DeserializationContext ctxt, Object delegate) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no array delegate creator specified", new Object[0]); }
  
  public Object createFromString(DeserializationContext ctxt, String value) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, ctxt.getParser(), "no String-argument constructor/factory method to deserialize from String value ('%s')", new Object[] { value }); }
  
  public Object createFromInt(DeserializationContext ctxt, int value) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no int/Int-argument constructor/factory method to deserialize from Number value (%s)", new Object[] { Integer.valueOf(value) }); }
  
  public Object createFromLong(DeserializationContext ctxt, long value) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no long/Long-argument constructor/factory method to deserialize from Number value (%s)", new Object[] { Long.valueOf(value) }); }
  
  public Object createFromBigInteger(DeserializationContext ctxt, BigInteger value) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no BigInteger-argument constructor/factory method to deserialize from Number value (%s)", new Object[] { value }); }
  
  public Object createFromDouble(DeserializationContext ctxt, double value) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no double/Double-argument constructor/factory method to deserialize from Number value (%s)", new Object[] { Double.valueOf(value) }); }
  
  public Object createFromBigDecimal(DeserializationContext ctxt, BigDecimal value) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no BigDecimal/double/Double-argument constructor/factory method to deserialize from Number value (%s)", new Object[] { value }); }
  
  public Object createFromBoolean(DeserializationContext ctxt, boolean value) throws IOException { return ctxt.handleMissingInstantiator(getValueClass(), this, null, "no boolean/Boolean-argument constructor/factory method to deserialize from boolean value (%s)", new Object[] { Boolean.valueOf(value) }); }
  
  public AnnotatedWithParams getDefaultCreator() { return null; }
  
  public AnnotatedWithParams getDelegateCreator() { return null; }
  
  public AnnotatedWithParams getArrayDelegateCreator() { return null; }
  
  public AnnotatedWithParams getWithArgsCreator() { return null; }
  
  @Deprecated
  protected Object _createFromStringFallbacks(DeserializationContext ctxt, String value) throws IOException {
    if (value.isEmpty() && 
      ctxt.isEnabled(DeserializationFeature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT))
      return null; 
    if (canCreateFromBoolean())
      if (ctxt.findCoercionAction(LogicalType.Boolean, Boolean.class, CoercionInputShape.String) == CoercionAction.TryConvert) {
        String str = value.trim();
        if ("true".equals(str))
          return createFromBoolean(ctxt, true); 
        if ("false".equals(str))
          return createFromBoolean(ctxt, false); 
      }  
    return ctxt.handleMissingInstantiator(getValueClass(), this, ctxt.getParser(), "no String-argument constructor/factory method to deserialize from String value ('%s')", new Object[] { value });
  }
}
