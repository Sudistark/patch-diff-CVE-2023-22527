package com.mysema.query.sql.types;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class EnumByNameType<T extends Enum<T>> extends AbstractType<T> {
  private final Class<T> type;
  
  public EnumByNameType(Class<T> type) { this(12, type); }
  
  public EnumByNameType(int jdbcType, Class<T> type) {
    super(jdbcType);
    this.type = type;
  }
  
  public Class<T> getReturnedClass() { return this.type; }
  
  public T getValue(ResultSet rs, int startIndex) throws SQLException {
    String name = rs.getString(startIndex);
    return (T)((name != null) ? Enum.valueOf(this.type, name) : null);
  }
  
  public void setValue(PreparedStatement st, int startIndex, T value) throws SQLException { st.setString(startIndex, value.name()); }
}
